module.exports=[15118,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(71987),e=a.i(38246),f=a.i(50944);let g=[".csv",".xlsx",".xls"];function h(a){return String(a??"").trim()}function i(a){let b=Number(a);return Number.isFinite(b)?b:0}function j(a){let b=a=>String(a).padStart(2,"0");return`${b(a.getDate())}/${b(a.getMonth()+1)}/${a.getFullYear()}, ${b(a.getHours())}:${b(a.getMinutes())}:${b(a.getSeconds())}`}async function k(a){try{let b=await a.slice(0,4).arrayBuffer(),c=new Uint8Array(b);return 80===c[0]&&75===c[1]}catch{return!1}}async function l(a){let b=(a.name||"").toLowerCase().trim();if(!b)return{ok:!1,error:"Invalid file name."};if(a.size>8388608)return{ok:!1,error:"File too large. Max 8MB."};let c=await k(a),d=b.endsWith(".csv")&&!c,e=b.endsWith(".xlsx")||b.endsWith(".xls")||c;return d||e?{ok:!0,kind:d?"CSV":"XLSX"}:{ok:!1,error:`Upload only: ${g.join(", ")}`}}function m(){let g=(0,f.useRouter)(),k=(0,c.useRef)(null),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)("light"),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)("CSV"),[O,P]=(0,c.useState)(0),[Q,R]=(0,c.useState)(!0),[S,T]=(0,c.useState)([]),[U,V]=(0,c.useState)(null);function W(a){V(a),window.setTimeout(()=>V(null),2600)}function X(){let a="dark"===o?"light":"dark";p(a),document.documentElement.dataset.theme=a,localStorage.setItem("rp_theme",a)}async function Y(){try{await fetch("/api/auth/logout",{method:"POST"})}finally{localStorage.removeItem("rp_user"),window.location.href="/login"}}async function Z(){J(!0);try{let a=localStorage.getItem("rp_user")||"",b=await fetch("/api/customers/import-batches",{method:"GET",headers:{"x-rp-user":a}}),c=await b.json().catch(()=>({}));if(!b.ok||!c.ok)throw Error(c.error||"Failed to load batches");H(Array.isArray(c.batches)?c.batches:[])}catch(a){console.warn(a?.message||a)}finally{J(!1)}}(0,c.useEffect)(()=>{let a="dark"===localStorage.getItem("rp_theme")?"dark":"light";p(a),document.documentElement.dataset.theme=a;let b=localStorage.getItem("rp_user");if(!b)return void g.replace("/login");try{let a=JSON.parse(b),c=String(a?.role||""),d="admin"===c.toLowerCase();t(c||"â€”"),v(d),r(j(new Date)),Z()}catch{g.replace("/login")}},[g]);let $=(0,c.useMemo)(()=>{let a=A.length,b=A.filter(a=>!a.error).length;return{total:a,ok:b,bad:a-b}},[A]),_=(0,c.useMemo)(()=>{let a=E.trim().toLowerCase();return a?A.filter(b=>`${b.customer_code} ${b.customer_name} ${b.client_name} ${b.phone_no} ${b.whatsapp_no} ${b.vat_no} ${b.brn}`.toLowerCase().includes(a)):A},[A,E]);function aa(){let a=new Blob(["customer_code,customer_name,client_name,address,phone_no,whatsapp_no,brn,vat_no\nCUST-001,Ram Trading Ltd,Ram Group,Royal Road Port Louis,51234567,58277852,BRN12345678,VAT123456\nCUST-002,Blue Stone Co,Blue Group,Quatre Bornes,59887766,59000000,BRN99887766,VAT998877"],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download="customers_import_template.csv",document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(b)}async function ab(a){return function(a){let b=(a.match(/\t/g)||[]).length>2*(a.match(/,/g)||[]).length?a.split("\n").map(a=>a.replace(/\t/g,",")).join("\n"):a,c=[],d=[],e="",f=!1;for(let a=0;a<b.length;a++){let g=b[a];if(f){'"'===g?'"'===b[a+1]?(e+='"',a++):f=!1:e+=g;continue}if('"'===g){f=!0;continue}if(","===g){d.push(e),e="";continue}if("\n"===g){d.push(e),e="",(d=d.map(a=>a.endsWith("\r")?a.slice(0,-1):a)).every(a=>!String(a??"").trim())||c.push(d),d=[];continue}e+=g}return d.push(e),(d=d.map(a=>a.endsWith("\r")?a.slice(0,-1):a)).every(a=>!String(a??"").trim())||c.push(d),c}(await a.text())}async function ac(b){let c;try{c=await a.A(98516)}catch{throw Error('XLSX support requires package "xlsx". Run: npm i xlsx')}let d=await b.arrayBuffer(),e=c.read(d,{type:"array"}),f=e.SheetNames?.[0];if(!f)throw Error("XLSX has no sheets.");let g=e.Sheets[f];return c.utils.sheet_to_json(g,{header:1,blankrows:!1})}async function ad(a){D(null),B([]),T([]),F(""),L((a.name||"").trim()||"customers_import"),P(a.size);let b=await l(a);if(!b.ok)return void D(b.error);N(b.kind);try{let c="CSV"===b.kind?await ab(a):await ac(a),{preview:d,apiRows:e}=function(a){if(!a||a.length<2)throw Error("File is empty. Add at least one data row.");let b=(a[0]||[]).map(a=>String(a??"").trim().toLowerCase().replace(/\uFEFF/g,"").replace(/[^\w]+/g,"_").replace(/^_+|_+$/g,"")),c=a=>b.findIndex(b=>b===a),d=c("customer_code"),e=c("customer_name"),f=c("client_name"),g=c("address"),i=c("phone_no"),j=c("whatsapp_no"),k=c("brn"),l=c("vat_no"),m=[["customer_code",d],["customer_name",e],["client_name",f],["address",g],["phone_no",i],["whatsapp_no",j],["brn",k],["vat_no",l]].filter(([,a])=>-1===a).map(([a])=>a);if(m.length)throw Error(`Missing column(s): ${m.join(", ")}
Required columns: customer_code, customer_name, client_name, address, phone_no, whatsapp_no, brn, vat_no`);let n=[],o=[];for(let b=1;b<a.length;b++){let c=a[b]||[],m=b,p=h(c[d]).toUpperCase(),q=h(c[e]),r=h(c[f]),s=h(c[g]),t=h(c[i]),u=h(c[j]),v=h(c[k]),w=h(c[l]),x={rowNo:m,customer_code:p,customer_name:q,client_name:r,address:s,phone_no:t,whatsapp_no:u,brn:v,vat_no:w};p?q||(x.error="Missing customer_name"):x.error="Missing customer_code",n.push(x),o.push({customer_code:p,customer_name:q,client_name:r,address:s,phone_no:t,whatsapp_no:u,brn:v,vat_no:w})}return{preview:n,apiRows:o}}(c);B(d),T(e)}catch(a){D(a?.message||"Failed to read file.")}}async function ae(a){if(D(null),!u&&"IMPORT"===a)return void D("Locked: only Admin can import customers.");if(!S.length)return void D("No rows loaded.");z(!0);try{let b=localStorage.getItem("rp_user")||"",c=await fetch("/api/customers/bulk-import",{method:"POST",headers:{"Content-Type":"application/json","x-rp-user":b},body:JSON.stringify({mode:a,clearExisting:"IMPORT"===a&&Q,filename:K||"customers_import",fileType:M,fileSize:O,rows:S})}),d=await c.json().catch(()=>({}));if(!c.ok||!d.ok)throw Error(d.error||"Request failed");if("DRY_RUN"===a){let a=d.summary||{};W(`Dry run âœ… Rows: ${i(a.rowCount)} â€¢ Valid: ${i(a.validCount)} â€¢ Errors: ${i(a.errorCount)}`);return}let e=d.summary||{},f=String(d.batchId||"");W(`Import done âœ…  Batch: ${f||"â€”"}  Rows: ${i(e.rowCount)}  Valid: ${i(e.validCount)}  Errors: ${i(e.errorCount)}`),x(!1),B([]),T([]),F(""),L(""),N("CSV"),P(0),r(j(new Date)),await Z()}catch(a){D(a?.message||"Bulk import failed")}finally{z(!1)}}async function af(a){if(!u)return void W("Admin only: rollback locked.");try{let b=localStorage.getItem("rp_user")||"",c=await fetch(`/api/customers/import-batches/${encodeURIComponent(a)}/rollback`,{method:"POST",headers:{"x-rp-user":b}}),d=await c.json().catch(()=>({}));if(!c.ok||!d.ok)throw Error(d.error||"Rollback failed");W("Rollback done âœ…"),await Z()}catch(a){W(`Rollback failed: ${a?.message||"Error"}`)}}return(0,b.jsxs)("div",{className:"rp-app",children:[(0,b.jsxs)("div",{className:"rp-bg","aria-hidden":"true",children:[(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--1"}),(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--2"}),(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--3"}),(0,b.jsx)("div",{className:"rp-bg-grid"})]}),U&&(0,b.jsx)("div",{style:{position:"fixed",right:18,top:16,zIndex:9999,padding:"10px 14px",borderRadius:14,background:"rgba(255,255,255,.92)",border:"1px solid rgba(0,0,0,.12)",boxShadow:"0 16px 50px rgba(0,0,0,.18)",fontWeight:950,backdropFilter:"blur(10px)",maxWidth:520},children:U}),(0,b.jsxs)("div",{className:"rp-shell rp-enter",children:[(0,b.jsxs)("div",{className:"rp-mtop",children:[(0,b.jsx)("button",{type:"button",className:"rp-icon-btn rp-burger",onClick:()=>n(!0),"aria-label":"Open menu",children:(0,b.jsxs)("span",{"aria-hidden":"true",children:[(0,b.jsx)("i",{}),(0,b.jsx)("i",{}),(0,b.jsx)("i",{})]})}),(0,b.jsxs)("div",{className:"rp-mtop-brand",children:[(0,b.jsx)("div",{className:"rp-mtop-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-mtop-sub",children:"Customer Import"})]}),(0,b.jsx)("button",{type:"button",className:"rp-icon-btn",onClick:X,"aria-label":"Toggle theme",children:"dark"===o?"â˜€":"ðŸŒ™"})]}),(0,b.jsx)("button",{className:`rp-overlay ${m?"is-open":""}`,onClick:()=>n(!1),"aria-label":"Close menu"}),(0,b.jsxs)("aside",{className:`rp-drawer ${m?"is-open":""}`,children:[(0,b.jsxs)("div",{className:"rp-drawer-head",children:[(0,b.jsxs)("div",{className:"rp-drawer-brand",children:[(0,b.jsx)("div",{className:"rp-drawer-logo",children:(0,b.jsx)(d.default,{src:"/images/logo/logo.png",alt:"Ram Pottery Ltd",width:28,height:28,priority:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-drawer-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-drawer-sub",children:"Accounting & Stock System"})]})]}),(0,b.jsx)("button",{type:"button",className:"rp-icon-btn",onClick:()=>n(!1),"aria-label":"Close",children:"âœ•"})]}),(0,b.jsxs)("div",{className:"rp-drawer-body",children:[(0,b.jsx)("nav",{className:"rp-nav",children:[{href:"/",label:"Dashboard"},{href:"/invoices",label:"Invoices"},{href:"/credit-notes",label:"Credit Notes"},{href:"/stock",label:"Stock & Categories"},{href:"/stock-movements",label:"Stock Movements"},{href:"/customers",label:"Customers"},{href:"/reports",label:"Reports & Statements"}].map(a=>(0,b.jsxs)(e.default,{className:`rp-nav-btn ${"/customers"===a.href?"rp-nav-btn--active":""}`,href:a.href,onClick:()=>n(!1),children:[(0,b.jsx)("span",{className:"rp-ic3d","aria-hidden":"true",children:"â–¶"}),a.label]},a.href))}),(0,b.jsxs)("div",{className:"rp-side-footer rp-side-footer--in",children:[(0,b.jsxs)("div",{className:"rp-role",children:[(0,b.jsx)("span",{children:"Role"}),(0,b.jsx)("b",{children:s||"â€”"})]}),(0,b.jsxs)("div",{className:"rp-role",style:{marginTop:10},children:[(0,b.jsx)("span",{children:"Import"}),(0,b.jsx)("b",{children:u?"Admin enabled":"Locked"})]})]})]})]}),(0,b.jsx)("aside",{className:"rp-side",children:(0,b.jsxs)("div",{className:"rp-side-card rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-brand",children:[(0,b.jsx)("div",{className:"rp-brand-logo",children:(0,b.jsx)(d.default,{src:"/images/logo/logo.png",alt:"Ram Pottery Ltd",width:30,height:30,priority:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-brand-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-brand-sub",children:"Accounting & Stock System"})]})]}),(0,b.jsx)("nav",{className:"rp-nav",children:[{href:"/",label:"Dashboard"},{href:"/invoices",label:"Invoices"},{href:"/credit-notes",label:"Credit Notes"},{href:"/stock",label:"Stock & Categories"},{href:"/stock-movements",label:"Stock Movements"},{href:"/customers",label:"Customers"},{href:"/reports",label:"Reports & Statements"}].map(a=>(0,b.jsxs)(e.default,{className:`rp-nav-btn ${"/customers"===a.href?"rp-nav-btn--active":""}`,href:a.href,children:[(0,b.jsx)("span",{className:"rp-ic3d","aria-hidden":"true",children:"â–¶"}),a.label]},a.href))}),(0,b.jsxs)("div",{className:"rp-side-footer rp-side-footer--in",children:[(0,b.jsxs)("div",{className:"rp-role",children:[(0,b.jsx)("span",{children:"Role"}),(0,b.jsx)("b",{children:s||"â€”"})]}),(0,b.jsxs)("div",{className:"rp-role",style:{marginTop:10},children:[(0,b.jsx)("span",{children:"Import"}),(0,b.jsx)("b",{children:u?"Admin enabled":"Locked"})]})]})]})}),(0,b.jsxs)("main",{className:"rp-main",children:[(0,b.jsxs)("header",{className:"rp-top rp-top--saas rp-card-anim",style:{animationDelay:"60ms"},children:[(0,b.jsxs)("div",{className:"rp-top-left--actions",children:[(0,b.jsxs)("button",{type:"button",className:"rp-ui-btn rp-ui-btn--brand",onClick:X,children:[(0,b.jsx)("span",{className:"rp-ui-btn__dot","aria-hidden":"true"}),"dark"===o?"â˜€ Light":"ðŸŒ™ Dark"]}),(0,b.jsxs)("button",{type:"button",className:"rp-ui-btn rp-ui-btn--danger",onClick:Y,children:[(0,b.jsx)("span",{className:"rp-ui-btn__dot","aria-hidden":"true"}),"Log Out"]})]}),(0,b.jsx)("div",{className:"rp-top-center--logo",children:(0,b.jsx)("div",{className:"rp-top-logo",children:(0,b.jsx)(d.default,{src:"/images/logo/logo.png",alt:"Ram Pottery",width:44,height:44,priority:!0})})}),(0,b.jsx)("div",{className:"rp-top-right--sync",children:(0,b.jsxs)("div",{className:"rp-sync",children:[(0,b.jsx)("div",{className:"rp-sync-label",children:"Last sync :"}),(0,b.jsx)("div",{className:"rp-sync-time",children:q||"â€”"})]})})]}),(0,b.jsxs)("section",{className:"rp-exec rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-exec__left",children:[(0,b.jsx)("div",{className:"rp-exec__title",children:"Customer Import"}),(0,b.jsxs)("div",{className:"rp-exec__sub",children:["Upload ",(0,b.jsx)("b",{children:"CSV / Excel"})," â€¢ Preview â€¢ ",(0,b.jsx)("b",{children:"Dry Run"})," â€¢ Import â€¢ Rollback (Admin)"]})]}),(0,b.jsxs)("div",{className:"rp-exec__right",children:[(0,b.jsx)("span",{className:`rp-chip rp-chip--soft ${u?"":"rp-chip--warn"}`,children:u?"Admin enabled":"Locked"}),(0,b.jsxs)("span",{className:"rp-chip",children:["Max ",8,"MB"]})]})]}),(0,b.jsxs)("section",{className:"rp-kpi-pro rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Rows loaded"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:$.total}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Current preview set"})]}),(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Valid"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:$.ok}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Ready"})]}),(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Errors"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:$.bad}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Fix and re-upload"})]}),(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Batches"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:G.length}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Server history"})]})]}),(0,b.jsx)("section",{className:"rp-actions rp-card-anim",children:(0,b.jsxs)("div",{className:"rp-seg rp-seg--pro",children:[(0,b.jsxs)(e.default,{className:"rp-seg-item rp-seg-item--brand",href:"/customers",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"â†"}),"Customers"]}),(0,b.jsxs)("button",{className:"rp-seg-item rp-seg-item--brand",type:"button",onClick:aa,children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"â¬‡"}),"Template"]}),u?(0,b.jsxs)("button",{className:"rp-seg-item rp-seg-item--brand",type:"button",onClick:function(){D(null),B([]),T([]),F(""),L(""),N("CSV"),P(0),R(!0),x(!0),setTimeout(()=>k.current?.click(),120)},children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"â¬†"}),"Import Customers"]}):(0,b.jsxs)("button",{className:"rp-seg-item",type:"button",disabled:!0,title:"Admin only",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"ðŸ”’"}),"Import Locked"]}),(0,b.jsxs)("button",{className:"rp-seg-item rp-seg-item--brand",type:"button",onClick:Z,disabled:I,children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"â†»"}),I?"Refreshingâ€¦":"Refresh Batches"]})]})}),(0,b.jsxs)("section",{className:"rp-card rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-card-head rp-card-head--tight",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-card-title",children:"Import Batches (Server)"}),(0,b.jsx)("div",{className:"rp-card-sub",children:"Each import creates a batch â€¢ Admin can rollback a batch"})]}),(0,b.jsxs)("span",{className:"rp-chip rp-chip--soft",children:[G.length," record(s)"]})]}),(0,b.jsx)("div",{className:"rp-card-body",children:0===G.length?(0,b.jsx)("div",{className:"rp-td-empty",children:"No batches yet."}):(0,b.jsx)("div",{className:"rp-table-wrap",children:(0,b.jsxs)("table",{className:"rp-table rp-table--premium",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{style:{width:190},children:"Date"}),(0,b.jsx)("th",{children:"File"}),(0,b.jsx)("th",{style:{width:120},children:"By"}),(0,b.jsx)("th",{style:{width:90},children:"Status"}),(0,b.jsx)("th",{style:{width:120,textAlign:"right"},children:"Rows"}),(0,b.jsx)("th",{style:{width:140,textAlign:"right"},children:"Valid"}),(0,b.jsx)("th",{style:{width:120,textAlign:"right"},children:"Errors"}),(0,b.jsx)("th",{style:{width:160},children:"Action"})]})}),(0,b.jsx)("tbody",{children:G.map(a=>{let c=String(a.status||"â€”"),d=!!a.rolled_back_at;return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"rp-strong",children:function(a){try{return new Date("string"==typeof a?a:Number(a)).toLocaleString()}catch{return String(a||"")}}(a.created_at)}),(0,b.jsx)("td",{className:"rp-strong",children:a.filename||"â€”"}),(0,b.jsx)("td",{children:a.created_by||"â€”"}),(0,b.jsx)("td",{children:d?(0,b.jsxs)("span",{className:"rp-status rp-status-cancelled",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),"ROLLED_BACK"]}):"DONE"===c.toUpperCase()?(0,b.jsxs)("span",{className:"rp-status rp-status-approved",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),"DONE"]}):(0,b.jsxs)("span",{className:"rp-status rp-status-pending",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),c]})}),(0,b.jsx)("td",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:i(a.row_count)}),(0,b.jsx)("td",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:i(a.valid_count)}),(0,b.jsx)("td",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:i(a.error_count)}),(0,b.jsx)("td",{children:u?(0,b.jsx)("button",{type:"button",className:"rp-btn-red-outline",disabled:d,onClick:()=>af(String(a.id)),title:d?"Already rolled back":"Rollback this batch",children:d?"Rolled back":"Rollback"}):(0,b.jsx)("button",{type:"button",className:"rp-btn-red-outline",disabled:!0,title:"Admin only",children:"ðŸ”’ Locked"})})]},a.id)})})]})})})]}),(0,b.jsxs)("section",{className:"rp-card rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-card-head rp-card-head--tight",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-card-title",children:"How it works"}),(0,b.jsxs)("div",{className:"rp-card-sub",children:["Uses ",(0,b.jsx)("b",{children:"/api/customers/bulk-import"})," (Dry Run + Import) â€¢ Creates a server batch"]})]}),(0,b.jsx)("span",{className:"rp-chip",children:"CSV + XLSX"})]}),(0,b.jsxs)("div",{className:"rp-card-body",style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[(0,b.jsxs)("span",{className:"rp-status rp-status-issued",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),"Required: customer_code, customer_name, client_name, address, phone_no, whatsapp_no, brn, vat_no"]}),(0,b.jsxs)("span",{className:"rp-status rp-status-approved",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),"Dry Run validates server-side before Import"]}),(0,b.jsxs)("span",{className:"rp-status rp-status-pending",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),"Optional: Delete all existing customers before import"]})]})]}),(0,b.jsxs)("footer",{className:"rp-footer",children:["Â© ",new Date().getFullYear()," Ram Pottery Ltd â€¢ Built by Mobiz.mu"]})]}),(0,b.jsx)("input",{ref:k,type:"file",accept:".csv,text/csv,.xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",style:{display:"none"},onChange:async a=>{let b=a.currentTarget,c=b.files?.[0];c&&(b.value="",await ad(c))}}),w&&(0,b.jsx)("div",{className:"rp-modal-backdrop",onClick:()=>y?null:x(!1),children:(0,b.jsxs)("div",{className:"rp-modal",onClick:a=>a.stopPropagation(),style:{width:"min(1100px, calc(100vw - 32px))",maxHeight:"min(82vh, 780px)",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,b.jsxs)("div",{className:"rp-modal-head",children:[(0,b.jsx)("div",{className:"rp-modal-title",children:"Import Preview (CSV / XLSX)"}),(0,b.jsx)("button",{className:"rp-modal-x",onClick:()=>y?null:x(!1),"aria-label":"Close",children:"âœ•"})]}),(0,b.jsxs)("div",{className:"rp-modal-body",style:{overflow:"auto",paddingBottom:18},children:[(0,b.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:12,alignItems:"center"},children:[(0,b.jsx)("button",{className:"rp-btn-red",type:"button",onClick:()=>k.current?.click(),children:"Choose File"}),(0,b.jsx)("button",{className:"rp-btn-red-outline",type:"button",onClick:aa,children:"â¬‡ Download Template"}),(0,b.jsxs)("div",{style:{fontWeight:950,color:"rgba(0,0,0,.62)"},children:["Rows: ",(0,b.jsx)("b",{children:$.total})," â€¢ Valid: ",(0,b.jsx)("b",{children:$.ok})," â€¢ Errors: ",(0,b.jsx)("b",{children:$.bad}),K?(0,b.jsxs)(b.Fragment,{children:[" ","â€¢ File: ",(0,b.jsx)("b",{children:K})," (",M,")"]}):null]})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:10,alignItems:"center"},children:[(0,b.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:10,padding:"10px 12px",borderRadius:14,border:"1px solid rgba(0,0,0,.10)",background:"rgba(255,255,255,.7)",fontWeight:950},title:"If enabled, Import will delete all existing customers first.",children:[(0,b.jsx)("input",{type:"checkbox",checked:Q,onChange:a=>R(a.target.checked),disabled:!u||y,style:{width:18,height:18}}),"Delete all existing customers before import"]}),(0,b.jsx)("input",{className:"rp-input-premium",value:E,onChange:a=>F(a.target.value),placeholder:"Search in preview (code / name / phone / whatsapp)â€¦",style:{width:520,maxWidth:"100%"}}),(0,b.jsxs)("div",{style:{fontWeight:950,color:"rgba(0,0,0,.62)"},children:["Preview: ",(0,b.jsx)("b",{children:Math.min(_.length,50)})," row(s)"]})]}),C&&(0,b.jsx)("div",{style:{color:"rgba(227,6,19,0.95)",fontWeight:950,marginBottom:10,whiteSpace:"pre-wrap"},children:C}),A.length>0&&(0,b.jsx)("div",{className:"rp-table-wrap",style:{border:"1px solid rgba(0,0,0,.08)",borderRadius:14},children:(0,b.jsxs)("table",{className:"rp-table",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{style:{width:64},children:"Row"}),(0,b.jsx)("th",{style:{width:140},children:"Code"}),(0,b.jsx)("th",{children:"Name"}),(0,b.jsx)("th",{style:{width:160},children:"Phone"}),(0,b.jsx)("th",{style:{width:160},children:"WhatsApp"}),(0,b.jsx)("th",{style:{width:160},children:"BRN"}),(0,b.jsx)("th",{style:{width:160},children:"VAT No"}),(0,b.jsx)("th",{style:{width:220},children:"Status"})]})}),(0,b.jsx)("tbody",{children:_.slice(0,50).map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:a.rowNo}),(0,b.jsx)("td",{style:{fontWeight:950},children:a.customer_code||"â€”"}),(0,b.jsx)("td",{style:{fontWeight:950},children:a.customer_name||"â€”"}),(0,b.jsx)("td",{children:a.phone_no||"â€”"}),(0,b.jsx)("td",{children:a.whatsapp_no||"â€”"}),(0,b.jsx)("td",{children:a.brn||"â€”"}),(0,b.jsx)("td",{children:a.vat_no||"â€”"}),(0,b.jsx)("td",{children:a.error?(0,b.jsxs)("span",{className:"rp-status rp-status-cancelled",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),a.error]}):(0,b.jsxs)("span",{className:"rp-status rp-status-approved",children:[(0,b.jsx)("span",{className:"rp-status-dot"}),"Ready"]})})]},`${a.rowNo}-${a.customer_code}-${a.phone_no}-${a.whatsapp_no}`))})]})}),A.length>50&&(0,b.jsx)("div",{style:{marginTop:8,fontWeight:950,color:"rgba(0,0,0,.6)"},children:"Preview limited to first 50 rows."})]}),(0,b.jsxs)("div",{className:"rp-modal-foot",style:{display:"flex",gap:10},children:[(0,b.jsx)("button",{className:"rp-btn-red-outline",type:"button",onClick:()=>x(!1),disabled:y,children:"Cancel"}),(0,b.jsx)("button",{className:"rp-btn-red-outline",type:"button",onClick:()=>ae("DRY_RUN"),disabled:y||0===S.length,title:"Validate on server without writing to DB",children:y?"Workingâ€¦":"Dry Run"}),(0,b.jsx)("button",{className:"rp-btn-red",type:"button",onClick:()=>ae("IMPORT"),disabled:y||0===$.ok||!u,title:u?"Import to database":"Admin only",children:y?"Importingâ€¦":`Import ${$.ok} Customer(s)`})]})]})})]})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=app_customers_pricing-import_page_tsx_02373f07._.js.map