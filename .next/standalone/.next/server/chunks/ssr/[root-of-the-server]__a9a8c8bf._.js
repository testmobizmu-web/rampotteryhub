module.exports=[36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},71386,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);let e=[{key:"canViewReports",label:"Can view reports"},{key:"canEditInvoices",label:"Can create/edit invoices"},{key:"canEditPayments",label:"Can record payments"},{key:"canVoidInvoices",label:"Can void invoices/credit notes"},{key:"canEditStock",label:"Can edit stock"},{key:"canManageUsers",label:"Can manage users"}];function f(){let a=(0,d.useParams)(),f=(0,d.useRouter)(),g=a.id,[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("sales"),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)({});async function z(){try{i(!0),m(null);let a=await fetch(`/api/admin/users/${g}`,{cache:"no-store"}),b=await a.json();if(!a.ok||!b.ok)throw Error(b.error||"Failed");let c=b.user;o(c.username||""),q(c.full_name||""),s(c.phone||""),u(c.role||"sales"),w(!!c.is_active),y(c.permissions||{})}catch(a){m(a?.message||"Error")}finally{i(!1)}}(0,c.useEffect)(()=>{z()},[g]);let A=(0,c.useMemo)(()=>!0,[n,p,r,t,v,x]);async function B(a){try{k(!0),m(null);let b=await fetch(`/api/admin/users/${g}`,{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify({full_name:p,phone:r,role:t,is_active:v,permissions:x,applyPreset:a})}),c=await b.json();if(!b.ok||!c.ok)throw Error(c.error||"Failed");f.push("/admin/users")}catch(a){m(a?.message||"Error")}finally{k(!1)}}return h?(0,b.jsx)("div",{className:"text-sm opacity-70",children:"Loading…"}):(0,b.jsxs)("div",{className:"max-w-3xl space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Edit User"}),(0,b.jsx)("p",{className:"text-sm opacity-70",children:n})]}),(0,b.jsx)("button",{className:"px-4 py-2 rounded-xl border",onClick:()=>f.push("/admin/users"),children:"Back"})]}),l&&(0,b.jsx)("div",{className:"p-3 rounded-xl border text-sm",children:l}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"rounded-2xl border p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-sm opacity-70",children:"Full name"}),(0,b.jsx)("input",{className:"w-full border rounded-xl px-3 py-2",value:p,onChange:a=>q(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-sm opacity-70",children:"Phone"}),(0,b.jsx)("input",{className:"w-full border rounded-xl px-3 py-2",value:r,onChange:a=>s(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-sm opacity-70",children:"Role"}),(0,b.jsxs)("select",{className:"w-full border rounded-xl px-3 py-2",value:t,onChange:a=>u(a.target.value),children:[(0,b.jsx)("option",{value:"admin",children:"admin"}),(0,b.jsx)("option",{value:"accounting",children:"accounting"}),(0,b.jsx)("option",{value:"sales",children:"sales"}),(0,b.jsx)("option",{value:"viewer",children:"viewer"})]})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:v,onChange:a=>w(a.target.checked)}),"Active"]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)("button",{disabled:j||!A,className:"px-4 py-2 rounded-xl border",onClick:()=>B(!1),children:j?"Saving…":"Save"}),(0,b.jsx)("button",{disabled:j,className:"px-4 py-2 rounded-xl border",onClick:()=>B(!0),children:"Apply Preset + Save"})]})]}),(0,b.jsxs)("div",{className:"rounded-2xl border p-4 space-y-3",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Permissions"}),(0,b.jsx)("div",{className:"space-y-2",children:e.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!x[a.key],onChange:()=>{var b;return b=a.key,void y(a=>({...a,[b]:!a[b]}))}}),a.label]},a.key))})]})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a9a8c8bf._.js.map