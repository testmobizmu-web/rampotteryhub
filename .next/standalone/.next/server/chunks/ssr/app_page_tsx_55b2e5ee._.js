module.exports=[60350,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(71987),e=a.i(72131),f=a.i(24767);function g(a){let b=Number.isFinite(a)?a:0,c=new Intl.NumberFormat("en-US",{maximumFractionDigits:0,minimumFractionDigits:0});return`Rs ${c.format(b)}`}function h({status:a}){let c,d=(c=(a||"").toLowerCase()).includes("paid")?"paid":c.includes("partial")?"partial":c.includes("void")||c.includes("cancel")?"void":c.includes("refund")?"refund":c||"issued";return(0,b.jsx)("span",{className:"paid"===d?"rp-badge rp-badge--paid":"partial"===d?"rp-badge rp-badge--partial":"void"===d?"rp-badge rp-badge--void":"refund"===d?"rp-badge rp-badge--refund":"rp-badge rp-badge--issued",children:"paid"===d?"Paid":"partial"===d?"Partial":"void"===d?"Void":"refund"===d?"Refund":"Issued"})}function i(a){let b=a.qty??a.stock_qty??0;return Number.isFinite(Number(b))?Number(b):0}function j(a){let b=[],c=new Date;for(let d=a-1;d>=0;d--){let a=new Date(c.getFullYear(),c.getMonth()-d,1);b.push({d:a,ym:function(a){let b=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0");return`${b}-${c}`}(a),label:`${a.toLocaleString("en-GB",{month:"short"})} ${String(a.getFullYear()).slice(-2)}`})}return b}function k(){let[a,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)("light"),[n,o]=(0,e.useState)(""),[p,q]=(0,e.useState)(!0),[r,s]=(0,e.useState)(null),[t,u]=(0,e.useState)(null),[v,w]=(0,e.useState)(null),[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(null);(0,e.useEffect)(()=>{A(!0);let a="dark"===localStorage.getItem("rp_theme")?"dark":"light";m(a),document.documentElement.dataset.theme=a;try{let a=localStorage.getItem("rp_user");a&&C(JSON.parse(a))}catch{C(null)}},[]),(0,e.useEffect)(()=>{if("u">typeof document)return document.body.style.overflow=a?"hidden":"",()=>{document.body.style.overflow=""}},[a]),(0,e.useEffect)(()=>{let a=a=>{"Escape"===a.key&&k(!1)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[a]);let D=(0,e.useMemo)(()=>{let a;return"STAFF"===(a=String(B?.role||"STAFF").toUpperCase())?"STAFF":"ADMIN"===a?"ADMIN":"MANAGER"===a?"MANAGER":a},[B]),E=(0,e.useMemo)(()=>(B?.name||B?.username||"").trim()||"User",[B]),F=z&&"ADMIN"===String(B?.role||"").toUpperCase();function G(){let a="dark"===l?"light":"dark";m(a),document.documentElement.dataset.theme=a,localStorage.setItem("rp_theme",a)}async function H(){try{await fetch("/api/auth/logout",{method:"POST"})}finally{localStorage.removeItem("rp_user"),window.location.href="/login"}}async function I(){let a=new AbortController;try{var b;let c;q(!0),u(null);let d=await (0,f.rpFetch)("/api/dashboard/summary",{cache:"no-store",signal:a.signal});if(!d.ok){let a="";try{let b=await d.json();a=b?.error||b?.message||""}catch{a=await d.text().catch(()=>"")}throw Error(a||`Dashboard load failed (${d.status})`)}let e=await d.json();s(e),o((b=new Date,c=a=>String(a).padStart(2,"0"),`${c(b.getDate())}/${c(b.getMonth()+1)}/${b.getFullYear()}, ${c(b.getHours())}:${c(b.getMinutes())}:${c(b.getSeconds())}`))}catch(a){u(a?.message||"Failed to load dashboard")}finally{q(!1)}return()=>a.abort()}async function J(){y(!0);let a=j(6),b=a.map((b,c)=>({ym:b.ym,label:b.label,total:c===a.length-1?Number(r?.totalSalesMonth||0):0}));try{let b=await (0,f.rpFetch)("/api/reports/sales-6m",{cache:"no-store"});if(!b.ok)throw Error("sales-6m not available");let c=await b.json(),d=Array.isArray(c?.series)?c.series:[],e=new Map;for(let a of d)a?.ym&&e.set(String(a.ym),Number(a.total||0));let g=a.map(a=>({ym:a.ym,label:a.label,total:Number(e.get(a.ym)||0)}));w(g)}catch{w(b)}finally{y(!1)}}(0,e.useEffect)(()=>{I()},[]),(0,e.useEffect)(()=>{z&&J()},[z,r?.totalSalesMonth]);let K=r?.totalSalesToday??0,L=r?.totalSalesMonth??0,M=r?.outstanding??0,N=Array.isArray(r?.lowStock)?r.lowStock:[],O=N.length,P=r?.recentInvoices??[],Q=(0,e.useMemo)(()=>{let a=[...N];return a.sort((a,b)=>i(a)-i(b)),a.slice(0,6)},[N]),R=[{href:"/",label:"Dashboard"},{href:"/invoices",label:"Invoices"},{href:"/credit-notes",label:"Credit Notes"},{href:"/products",label:"Stock & Categories"},{href:"/stock-movements",label:"Stock Movements"},{href:"/customers",label:"Customers"},{href:"/suppliers",label:"Suppliers"},{href:"/reports",label:"Reports & Statements"}],S=(0,e.useMemo)(()=>{let a=[...R];return F&&a.push({href:"/admin/users",label:"Users & Permissions"}),a},[F]),T=v||j(6).map(a=>({ym:a.ym,label:a.label,total:0})),U=Math.max(1,...T.map(a=>Number(a.total||0))),V=(0,b.jsxs)("div",{className:"rp-side-card rp-card-anim",style:{minHeight:"100vh",paddingBottom:18,display:"flex",flexDirection:"column"},children:[(0,b.jsxs)("div",{className:"rp-brand",children:[(0,b.jsx)("div",{className:"rp-brand-logo",children:(0,b.jsx)(d.default,{src:"/images/logo/logo.png",alt:"Ram Pottery Ltd",width:30,height:30,priority:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-brand-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-brand-sub",children:"Accounting & Stock System"})]})]}),(0,b.jsx)("nav",{className:"rp-nav",style:{flex:1},children:S.map(a=>(0,b.jsxs)(c.default,{className:`rp-nav-btn ${"/"===a.href?"rp-nav-btn--active":""}`,href:a.href,onClick:()=>k(!1),prefetch:!1,children:[(0,b.jsx)("span",{className:"rp-ic3d","aria-hidden":"true",children:"â–¶"}),a.label]},a.href))}),(0,b.jsxs)("div",{className:"rp-side-footer rp-side-footer--in",style:{marginTop:"auto"},children:[(0,b.jsxs)("div",{className:"rp-role",children:[(0,b.jsx)("span",{children:"Signed in"}),(0,b.jsx)("b",{title:E,children:z?E:"â€”"})]}),(0,b.jsxs)("div",{className:"rp-role",style:{marginTop:10},children:[(0,b.jsx)("span",{children:"Role"}),(0,b.jsx)("b",{children:z?D:"â€”"})]})]})]});return(0,b.jsxs)("div",{className:"rp-app",children:[(0,b.jsxs)("div",{className:"rp-bg","aria-hidden":"true",children:[(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--1"}),(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--2"}),(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--3"}),(0,b.jsx)("div",{className:"rp-bg-grid"})]}),(0,b.jsxs)("div",{className:"rp-shell rp-enter",children:[(0,b.jsxs)("div",{className:"rp-mtop",children:[(0,b.jsx)("button",{type:"button",className:"rp-icon-btn rp-burger",onClick:()=>k(!0),"aria-label":"Open menu",children:(0,b.jsxs)("span",{"aria-hidden":"true",children:[(0,b.jsx)("i",{}),(0,b.jsx)("i",{}),(0,b.jsx)("i",{})]})}),(0,b.jsxs)("div",{className:"rp-mtop-brand",children:[(0,b.jsx)("div",{className:"rp-mtop-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-mtop-sub",children:"Executive Dashboard"})]}),(0,b.jsx)("button",{type:"button",className:"rp-icon-btn",onClick:G,"aria-label":"Toggle theme",title:"Toggle theme",children:"dark"===l?"â˜€":"ðŸŒ™"})]}),(0,b.jsx)("button",{className:`rp-overlay ${a?"is-open":""}`,onClick:()=>k(!1),"aria-label":"Close menu"}),(0,b.jsxs)("aside",{className:`rp-drawer ${a?"is-open":""}`,children:[(0,b.jsxs)("div",{className:"rp-drawer-head",children:[(0,b.jsxs)("div",{className:"rp-drawer-brand",children:[(0,b.jsx)("div",{className:"rp-drawer-logo",children:(0,b.jsx)(d.default,{src:"/images/logo/logo.png",alt:"Ram Pottery Ltd",width:28,height:28,priority:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-drawer-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-drawer-sub",children:"Accounting & Stock System"})]})]}),(0,b.jsx)("button",{type:"button",className:"rp-icon-btn",onClick:()=>k(!1),"aria-label":"Close",children:"âœ•"})]}),(0,b.jsx)("div",{className:"rp-drawer-body",children:V})]}),(0,b.jsx)("aside",{className:"rp-side",children:V}),(0,b.jsxs)("main",{className:"rp-main",children:[(0,b.jsxs)("header",{className:"rp-top rp-top--saas rp-card-anim",style:{animationDelay:"60ms"},children:[(0,b.jsxs)("div",{className:"rp-top-left--actions",children:[(0,b.jsxs)("button",{type:"button",className:"rp-ui-btn rp-ui-btn--brand",onClick:G,title:"Toggle theme",children:[(0,b.jsx)("span",{className:"rp-ui-btn__dot","aria-hidden":"true"}),"dark"===l?"â˜€ Light":"ðŸŒ™ Dark"]}),(0,b.jsxs)("button",{type:"button",className:"rp-ui-btn rp-ui-btn--danger",onClick:H,title:"Logout",children:[(0,b.jsx)("span",{className:"rp-ui-btn__dot","aria-hidden":"true"}),"Log Out"]})]}),(0,b.jsx)("div",{className:"rp-top-center--logo",children:(0,b.jsx)("div",{className:"rp-top-logo",children:(0,b.jsx)(d.default,{src:"/images/logo/logo.png",alt:"Ram Pottery",width:44,height:44,priority:!0})})}),(0,b.jsx)("div",{className:"rp-top-right--sync",children:(0,b.jsxs)("div",{className:"rp-sync",children:[(0,b.jsx)("div",{className:"rp-sync-label",children:"Last sync :"}),(0,b.jsx)("div",{className:"rp-sync-time",children:n||"â€”"})]})})]}),(0,b.jsxs)("section",{className:"rp-exec rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-exec__left",children:[(0,b.jsx)("div",{className:"rp-exec__title",children:"Executive Overview"}),(0,b.jsx)("div",{className:"rp-exec__sub",children:"Sales performance + operational alerts + quick actions"})]}),(0,b.jsxs)("div",{className:"rp-exec__right",children:[(0,b.jsxs)("span",{className:`rp-live ${p?"is-dim":""}`,children:[(0,b.jsx)("span",{className:"rp-live-dot","aria-hidden":"true"}),p?"Syncing":"Live"]}),(0,b.jsx)("span",{className:`rp-chip rp-chip--soft ${t?"rp-chip--warn":""}`,children:t?"Attention needed":"All systems normal"})]})]}),(0,b.jsx)("section",{className:"rp-actions rp-card-anim",children:(0,b.jsxs)("div",{className:"rp-seg rp-seg--pro",children:[(0,b.jsxs)(c.default,{className:"rp-seg-item rp-seg-item--brand",href:"/invoices/new",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"ðŸ§¾"}),"New Invoice"]}),(0,b.jsxs)(c.default,{className:"rp-seg-item rp-seg-item--brand",href:"/invoices",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"ðŸ–¨ï¸"}),"Reprint Invoices"]}),(0,b.jsxs)(c.default,{className:"rp-seg-item rp-seg-item--brand",href:"/credit-notes",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"ðŸ§¾"}),"Credit Notes"]}),(0,b.jsxs)(c.default,{className:"rp-seg-item rp-seg-item--brand",href:"/products/import",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"ðŸ“¦"}),"Import Stock"]}),(0,b.jsxs)(c.default,{className:"rp-seg-item rp-seg-item--brand",href:"/suppliers",children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"ðŸ¤"}),"Suppliers"]}),(0,b.jsxs)("button",{type:"button",className:"rp-seg-item",onClick:()=>{I(),J()},children:[(0,b.jsx)("span",{className:"rp-icbtn","aria-hidden":"true",children:"âŸ³"}),"Refresh"]})]})}),(0,b.jsxs)("section",{className:"rp-kpi-pro rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Sales Today"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:g(K)}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Invoices dated today"})]}),(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Sales This Month"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:g(L)}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Month to date"})]}),(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Outstanding"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:g(M)}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Total balance due"})]}),(0,b.jsxs)("div",{className:"rp-kpi-pro__cell",children:[(0,b.jsx)("div",{className:"rp-kpi-pro__title",children:"Low Stock"}),(0,b.jsx)("div",{className:"rp-kpi-pro__value",children:O}),(0,b.jsx)("div",{className:"rp-kpi-pro__sub",children:"Reorder suggested"})]})]}),(0,b.jsxs)("section",{className:"rp-grid2 rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-stack",children:[(0,b.jsxs)("div",{className:"rp-card rp-glass",children:[(0,b.jsxs)("div",{className:"rp-card-head",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-card-title",children:"Sales Trend"}),(0,b.jsx)("div",{className:"rp-card-sub",children:"Last 6 months (auto)"})]}),(0,b.jsx)("span",{className:"rp-pill",children:x?"Updatingâ€¦":"Executive view"})]}),(0,b.jsxs)("div",{className:"rp-card-body",children:[(0,b.jsx)("div",{className:"rp-chart",children:T.map(a=>{let c=Number(a.total||0),d=Math.max(3,Math.round(c/U*100));return(0,b.jsxs)("div",{className:"rp-chart-col",children:[(0,b.jsx)("div",{className:"rp-chart-top",children:(0,b.jsx)("span",{className:"rp-chart-val",children:g(c)})}),(0,b.jsx)("div",{className:"rp-chart-barwrap",children:(0,b.jsx)("div",{className:"rp-chart-bar",style:{height:`${d}%`}})}),(0,b.jsx)("div",{className:"rp-chart-label",children:a.label})]},a.ym)})}),(0,b.jsxs)("div",{className:"rp-chart-foot",children:[(0,b.jsxs)("span",{className:"rp-soft-pill",children:["Max: ",g(U)]}),(0,b.jsxs)("span",{className:"rp-soft-pill",children:["This month: ",g(L)]}),(0,b.jsxs)("span",{className:"rp-soft-pill",children:["Today: ",g(K)]})]})]})]}),(0,b.jsxs)("div",{className:"rp-card rp-glass",style:{marginTop:14},children:[(0,b.jsxs)("div",{className:"rp-card-head",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-card-title",children:"Low Stock Alerts"}),(0,b.jsx)("div",{className:"rp-card-sub",children:"Top items needing reorder"})]}),(0,b.jsx)(c.default,{className:"rp-link-btn",href:"/products",children:"Open stock â†’"})]}),(0,b.jsx)("div",{className:"rp-card-body",children:p?(0,b.jsxs)("div",{className:"rp-empty",children:[(0,b.jsx)("b",{children:"Loadingâ€¦"}),(0,b.jsx)("span",{children:"Checking inventory levels."})]}):t?(0,b.jsxs)("div",{className:"rp-empty",children:[(0,b.jsx)("b",{children:"Could not load stock alerts"}),(0,b.jsx)("span",{children:t})]}):0===Q.length?(0,b.jsxs)("div",{className:"rp-empty",children:[(0,b.jsx)("b",{children:"All good"}),(0,b.jsx)("span",{children:"No low-stock items detected."})]}):(0,b.jsx)("div",{className:"rp-alerts",children:Q.map((a,c)=>{let d=(a.item_code||"").trim()||`ITEM-${c+1}`,e=(a.name||"").trim()||"Unnamed product",f=i(a),g=Number(a.min_qty??0)||0;return(0,b.jsxs)("div",{className:"rp-alert-row",children:[(0,b.jsxs)("div",{className:"rp-alert-left",children:[(0,b.jsx)("div",{className:"rp-alert-code",children:d}),(0,b.jsx)("div",{className:"rp-alert-name",title:e,children:e})]}),(0,b.jsxs)("div",{className:"rp-alert-right",children:[(0,b.jsxs)("span",{className:`rp-pill2 ${f<=0?"rp-pill2--danger":"rp-pill2--warn"}`,children:[f," in stock"]}),(0,b.jsxs)("span",{className:"rp-pill2 rp-pill2--soft",children:["Min ",g]})]})]},`${d}-${c}`)})})})]})]}),(0,b.jsxs)("div",{className:"rp-card rp-glass",children:[(0,b.jsxs)("div",{className:"rp-card-head",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-card-title",children:"System Status"}),(0,b.jsx)("div",{className:"rp-card-sub",children:"Operational overview"})]}),(0,b.jsx)("span",{className:"rp-pill",children:"Secure"})]}),(0,b.jsxs)("div",{className:"rp-card-body",children:[(0,b.jsxs)("div",{className:"rp-status",children:[(0,b.jsxs)("div",{className:"rp-status-row",children:[(0,b.jsx)("span",{className:"rp-status-k",children:"Data sync"}),(0,b.jsx)("span",{className:`rp-status-v ${p?"is-dim":""}`,children:p?"Syncingâ€¦":"OK"})]}),(0,b.jsxs)("div",{className:"rp-status-row",children:[(0,b.jsx)("span",{className:"rp-status-k",children:"Invoices"}),(0,b.jsx)("span",{className:"rp-status-v",children:"Ready"})]}),(0,b.jsxs)("div",{className:"rp-status-row",children:[(0,b.jsx)("span",{className:"rp-status-k",children:"Stock"}),(0,b.jsx)("span",{className:"rp-status-v",children:O>0?"Attention":"OK"})]}),(0,b.jsxs)("div",{className:"rp-status-row",children:[(0,b.jsx)("span",{className:"rp-status-k",children:"Suppliers"}),(0,b.jsx)("span",{className:"rp-status-v",children:"Ready"})]}),(0,b.jsxs)("div",{className:"rp-status-row",children:[(0,b.jsx)("span",{className:"rp-status-k",children:"Role"}),(0,b.jsx)("span",{className:"rp-status-v",children:z?D:"â€”"})]})]}),(0,b.jsx)("div",{className:"rp-status-note",children:"Premium executive dashboard â€” lightweight, fast, and focused on action."}),(0,b.jsxs)("div",{style:{marginTop:14,display:"grid",gap:10},children:[(0,b.jsx)(c.default,{className:"rp-link-btn",href:"/products",children:"Stock & Categories â†’"}),(0,b.jsx)(c.default,{className:"rp-link-btn",href:"/suppliers",children:"Suppliers â†’"}),(0,b.jsx)(c.default,{className:"rp-link-btn",href:"/reports",children:"Reports & Statements â†’"})]})]})]})]}),(0,b.jsxs)("section",{className:"rp-card rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-card-head rp-card-head--tight",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-card-title",children:"Recent Invoices"}),(0,b.jsx)("div",{className:"rp-card-sub",children:"Latest 10"})]}),(0,b.jsx)(c.default,{className:"rp-link-btn",href:"/invoices",children:"View all â†’"})]}),(0,b.jsx)("div",{className:"rp-card-body",children:p?(0,b.jsxs)("div",{className:"rp-empty",children:[(0,b.jsx)("b",{children:"Loading recent invoicesâ€¦"}),(0,b.jsx)("span",{children:"Please wait."})]}):t?(0,b.jsxs)("div",{className:"rp-empty",children:[(0,b.jsx)("b",{children:"Could not load invoices"}),(0,b.jsx)("span",{children:t})]}):(0,b.jsx)("div",{className:"rp-table-wrap",children:(0,b.jsxs)("table",{className:"rp-table",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Invoice"}),(0,b.jsx)("th",{children:"Date"}),(0,b.jsx)("th",{children:"Customer"}),(0,b.jsx)("th",{children:"Total"}),(0,b.jsx)("th",{children:"Status"})]})}),(0,b.jsx)("tbody",{children:0===P.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"rp-td-empty",colSpan:5,children:"No invoices yet."})}):P.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"rp-strong",children:(0,b.jsx)(c.default,{className:"rp-row-link",href:`/invoices/${a.id}`,children:a.invoice_number||`#${a.id}`})}),(0,b.jsx)("td",{children:a.invoice_date||"â€”"}),(0,b.jsx)("td",{children:a.customers?.name||"â€”"}),(0,b.jsx)("td",{className:"rp-strong",children:g(Number(a.total_amount||0))}),(0,b.jsx)("td",{children:(0,b.jsx)(h,{status:a.status})})]},String(a.id)))})]})})})]}),(0,b.jsxs)("footer",{className:"rp-footer",children:["Â© 2026 Ram Pottery Ltd - ",(0,b.jsx)("span",{children:"Built by Mobiz.mu"})]})]})]})]})}a.s(["default",()=>k])}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map