module.exports=[35149,a=>{"use strict";var b=a.i(87924),c=a.i(31626),d=a.i(72131),e=a.i(38246),f=a.i(71987),g=a.i(50944),h=a.i(24767);function i(a){return String(a||"").toUpperCase()}function j(){var a;let j,k=(0,g.useRouter)(),[l,m]=(0,d.useState)(!1),[n,o]=(0,d.useState)(!1),[p,q]=(0,d.useState)("light"),[r,s]=(0,d.useState)("â€”"),[t,u]=(0,d.useState)(null),[v,w]=(0,d.useState)(null),x=(0,d.useMemo)(()=>i(t?.role)||function(){try{return(localStorage.getItem("rp_role")||localStorage.getItem("role")||"ADMIN").toUpperCase()}catch{return"ADMIN"}}(),[t?.role]),[y,z]=(0,d.useState)(!1),[A,B]=(0,d.useState)(null),[C,D]=(0,d.useState)({customer_code:"",client:"",client_name:"",brn:"",vat_no:"",discount_percent:"0",whatsapp:"",name:"",phone:"",email:"",address:"",opening_balance:"0.00"});function E(a){let b=String(a||"").replace(/[^\d]/g,"");return b?8===b.length?"230"+b:(b.startsWith("230")&&b.length,b):""}function F(a,b){D(c=>({...c,[a]:b}))}let G=(0,d.useRef)(null),H=(0,d.useRef)(!1);function I(){y||k.push("/customers")}function J(){let a="dark"===p?"light":"dark";q(a),document.documentElement.dataset.theme=a,localStorage.setItem("rp_theme",a)}async function K(){try{await fetch("/api/auth/logout",{method:"POST"})}finally{localStorage.removeItem("rp_user"),window.location.href="/login"}}(0,d.useEffect)(()=>m(!0),[]),(0,d.useEffect)(()=>{let a="dark"===localStorage.getItem("rp_theme")?"dark":"light";q(a),document.documentElement.dataset.theme=a;try{var b;let a,c=localStorage.getItem("rp_user");if(!c)return void k.replace("/login");let d=JSON.parse(c);u(d),s((b=new Date,a=a=>String(a).padStart(2,"0"),`${a(b.getDate())}/${a(b.getMonth()+1)}/${b.getFullYear()}, ${a(b.getHours())}:${a(b.getMinutes())}:${a(b.getSeconds())}`))}catch{k.replace("/login")}},[]),(0,d.useEffect)(()=>{l&&window.setTimeout(()=>G.current?.focus(),50)},[l]),(0,d.useEffect)(()=>{if(!l)return;let a=a=>{"Escape"===a.key&&(a.preventDefault(),I())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[l,y]);let L=(0,d.useMemo)(()=>(t?.name||t?.username||"").trim()||"User",[t]);async function M(){if(!H.current){H.current=!0;try{var a;let b;if(!C.name.trim())return void B("Customer name is required.");let c=E(C.whatsapp);if(a=C.whatsapp,!(!(b=E(a))||b.startsWith("230")&&11===b.length)){B("Invalid WhatsApp number. Mauritius only: 8 digits (e.g. 58277852) or 230 + 8 digits (e.g. 23058277852)."),H.current=!1;return}await (0,h.rpFetch)("/api/customers/create",{method:"POST",body:JSON.stringify({...C,whatsapp:c||null,discount_percent:Number(C.discount_percent||0),opening_balance:Number(C.opening_balance||0)})}),w("Customer created âœ…"),window.setTimeout(()=>w(null),2400),window.setTimeout(()=>k.push("/customers"),650)}catch(a){B(a?.message||"Failed to create customer"),H.current=!1}finally{z(!1)}}}let N=(0,d.useMemo)(()=>[{href:"/",label:"Dashboard"},{href:"/invoices",label:"Invoices"},{href:"/credit-notes",label:"Credit Notes"},{href:"/stock",label:"Stock & Categories"},{href:"/stock-movements",label:"Stock Movements"},{href:"/customers",label:"Customers"},{href:"/reports",label:"Reports & Statements"},..."ADMIN"===i(t?.role)?[{href:"/admin/users",label:"Users & Permissions"}]:[]],[t?.role]);return l?(0,b.jsxs)("div",{className:"rp-app",children:[(0,b.jsxs)("div",{className:"rp-bg","aria-hidden":"true",children:[(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--1"}),(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--2"}),(0,b.jsx)("div",{className:"rp-bg-orb rp-bg-orb--3"}),(0,b.jsx)("div",{className:"rp-bg-grid"})]}),v&&(0,b.jsx)("div",{style:{position:"fixed",right:18,top:16,zIndex:9999,padding:"10px 14px",borderRadius:14,background:"rgba(255,255,255,.92)",border:"1px solid rgba(0,0,0,.12)",boxShadow:"0 16px 50px rgba(0,0,0,.18)",fontWeight:950,backdropFilter:"blur(10px)",maxWidth:520},children:v}),(0,b.jsxs)("div",{className:"rp-shell rp-enter",children:[(0,b.jsxs)("div",{className:"rp-mtop",children:[(0,b.jsx)("button",{type:"button",className:"rp-icon-btn rp-burger",onClick:()=>o(!0),"aria-label":"Open menu",children:(0,b.jsxs)("span",{"aria-hidden":"true",children:[(0,b.jsx)("i",{}),(0,b.jsx)("i",{}),(0,b.jsx)("i",{})]})}),(0,b.jsxs)("div",{className:"rp-mtop-brand",children:[(0,b.jsx)("div",{className:"rp-mtop-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-mtop-sub",children:"New Customer"})]}),(0,b.jsx)("button",{type:"button",className:"rp-icon-btn",onClick:J,"aria-label":"Toggle theme",children:"dark"===p?"â˜€":"ðŸŒ™"})]}),(0,b.jsx)("button",{className:`rp-overlay ${n?"is-open":""}`,onClick:()=>o(!1),"aria-label":"Close menu"}),(0,b.jsxs)("aside",{className:`rp-drawer ${n?"is-open":""}`,children:[(0,b.jsxs)("div",{className:"rp-drawer-head",children:[(0,b.jsxs)("div",{className:"rp-drawer-brand",children:[(0,b.jsx)("div",{className:"rp-drawer-logo",children:(0,b.jsx)(f.default,{src:"/images/logo/logo.png",alt:"Ram Pottery Ltd",width:28,height:28,priority:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-drawer-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-drawer-sub",children:"Accounting & Stock System"})]})]}),(0,b.jsx)("button",{type:"button",className:"rp-icon-btn",onClick:()=>o(!1),"aria-label":"Close",children:"âœ•"})]}),(0,b.jsxs)("div",{className:"rp-drawer-body",children:[(0,b.jsx)("nav",{className:"rp-nav",children:N.map(a=>(0,b.jsxs)(e.default,{className:`rp-nav-btn ${"/customers"===a.href?"rp-nav-btn--active":""}`,href:a.href,onClick:()=>o(!1),prefetch:!1,children:[(0,b.jsx)("span",{className:"rp-ic3d","aria-hidden":"true",children:"â–¶"}),a.label]},a.href))}),(0,b.jsxs)("div",{className:"rp-side-footer rp-side-footer--in",children:[(0,b.jsxs)("div",{className:"rp-role",children:[(0,b.jsx)("span",{children:"Signed in"}),(0,b.jsx)("b",{title:L,children:L})]}),(0,b.jsxs)("div",{className:"rp-role",style:{marginTop:10},children:[(0,b.jsx)("span",{children:"Role"}),(0,b.jsx)("b",{children:x})]})]})]})]}),(0,b.jsx)("aside",{className:"rp-side",children:(0,b.jsxs)("div",{className:"rp-side-card rp-card-anim",children:[(0,b.jsxs)("div",{className:"rp-brand",children:[(0,b.jsx)("div",{className:"rp-brand-logo",children:(0,b.jsx)(f.default,{src:"/images/logo/logo.png",alt:"Ram Pottery Ltd",width:30,height:30,priority:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"rp-brand-title",children:"RampotteryHUB"}),(0,b.jsx)("div",{className:"rp-brand-sub",children:"Accounting & Stock System"})]})]}),(0,b.jsx)("nav",{className:"rp-nav",children:N.map(a=>(0,b.jsxs)(e.default,{className:`rp-nav-btn ${"/customers"===a.href?"rp-nav-btn--active":""}`,href:a.href,prefetch:!1,children:[(0,b.jsx)("span",{className:"rp-ic3d","aria-hidden":"true",children:"â–¶"}),a.label]},a.href))}),(0,b.jsxs)("div",{className:"rp-side-footer rp-side-footer--in",children:[(0,b.jsxs)("div",{className:"rp-role",children:[(0,b.jsx)("span",{children:"Signed in"}),(0,b.jsx)("b",{title:L,children:L})]}),(0,b.jsxs)("div",{className:"rp-role",style:{marginTop:10},children:[(0,b.jsx)("span",{children:"Role"}),(0,b.jsx)("b",{children:x})]})]})]})}),(0,b.jsxs)("main",{onKeyDown:function(a){if(!y){if("Escape"===a.key){a.preventDefault(),I();return}if("Enter"===a.key){let b=a.target;if("textarea"===(b?.tagName||"").toLowerCase()){(a.ctrlKey||a.metaKey)&&!a.shiftKey&&!a.altKey&&(a.preventDefault(),M());return}a.shiftKey||a.altKey||a.ctrlKey||a.metaKey||(a.preventDefault(),M())}}},className:"jsx-2933dc1af8e055cb rp-main",children:[(0,b.jsxs)("header",{style:{animationDelay:"60ms"},className:"jsx-2933dc1af8e055cb rp-top rp-top--saas rp-card-anim",children:[(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-top-left--actions",children:[(0,b.jsxs)(e.default,{className:"rp-ui-btn rp-ui-btn--brand",href:"/customers",prefetch:!1,children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-ui-btn__dot"}),"â† Customers"]}),(0,b.jsxs)("button",{type:"button",onClick:J,className:"jsx-2933dc1af8e055cb rp-ui-btn rp-ui-btn--brand",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-ui-btn__dot"}),"dark"===p?"â˜€ Light":"ðŸŒ™ Dark"]}),(0,b.jsxs)("button",{type:"button",onClick:K,className:"jsx-2933dc1af8e055cb rp-ui-btn rp-ui-btn--danger",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-ui-btn__dot"}),"Log Out"]})]}),(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-top-center--logo",children:(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-top-logo",children:(0,b.jsx)(f.default,{src:"/images/logo/logo.png",alt:"Ram Pottery",width:44,height:44,priority:!0})})}),(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-top-right--sync",children:(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-sync",children:[(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-sync-label",children:"Last sync :"}),(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-sync-time",children:r||"â€”"})]})})]}),(0,b.jsxs)("section",{className:"jsx-2933dc1af8e055cb rp-exec rp-card-anim",children:[(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-exec__left",children:[(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-exec__title",children:"Add Customer"}),(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-exec__sub",children:["Keyboard: ",(0,b.jsx)("b",{className:"jsx-2933dc1af8e055cb",children:"Enter"})," to save â€¢ ",(0,b.jsx)("b",{className:"jsx-2933dc1af8e055cb",children:"Esc"})," to cancel â€¢ Address: ",(0,b.jsx)("b",{className:"jsx-2933dc1af8e055cb",children:"Ctrl/Cmd+Enter"})," to save"]})]}),(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-exec__right",children:[(0,b.jsxs)("span",{className:`jsx-2933dc1af8e055cb rp-live ${y?"is-dim":""}`,children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-live-dot"}),y?"Saving":"Ready"]}),(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-chip rp-chip--soft",children:"Customers"})]})]}),(0,b.jsx)("section",{className:"jsx-2933dc1af8e055cb rp-actions rp-card-anim",children:(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-seg rp-seg--pro",children:[(0,b.jsxs)("button",{type:"button",onClick:I,disabled:y,className:"jsx-2933dc1af8e055cb rp-seg-item rp-seg-item--brand",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-icbtn",children:"â†©"}),"Cancel (Esc)"]}),(0,b.jsxs)("button",{type:"button",onClick:M,disabled:y,className:"jsx-2933dc1af8e055cb rp-seg-item rp-seg-item--brand",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-icbtn",children:"ï¼‹"}),y?"Savingâ€¦":"Create Customer (Enter)"]})]})}),(0,b.jsxs)("section",{className:"jsx-2933dc1af8e055cb rp-card rp-card-anim",children:[(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-card-head rp-card-head--tight",children:[(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb",children:[(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-card-title",children:"Customer Information"}),(0,b.jsx)("div",{className:"jsx-2933dc1af8e055cb rp-card-sub",children:"All fields are optional except customer name"})]}),(0,b.jsx)("span",{className:`jsx-2933dc1af8e055cb rp-chip ${y?"is-dim":""}`,children:y?"Workingâ€¦":"Ready"})]}),(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-card-body",children:[(0,b.jsxs)("div",{className:"jsx-2933dc1af8e055cb rp-form-grid",children:[(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Customer Code"}),(0,b.jsx)("input",{value:C.customer_code,onChange:a=>F("customer_code",a.target.value),className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Client Name"}),(0,b.jsx)("input",{value:C.client_name,onChange:a=>F("client_name",a.target.value),placeholder:"e.g. Mr Sunil / ABC Group",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"WhatsApp"}),(0,b.jsx)("input",{value:C.whatsapp,onChange:a=>F("whatsapp",a.target.value),onBlur:()=>{F("whatsapp",E(C.whatsapp))},placeholder:"e.g. 58277852 or 23058277852",className:"jsx-2933dc1af8e055cb rp-input"}),(0,b.jsx)("div",{style:{marginTop:6,fontWeight:900},className:"jsx-2933dc1af8e055cb rp-muted",children:C.whatsapp?`Saved as: ${E(C.whatsapp)}`:"Optional"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"BRN"}),(0,b.jsx)("input",{value:C.brn,onChange:a=>F("brn",a.target.value),placeholder:"e.g. C17144377",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"VAT No"}),(0,b.jsx)("input",{value:C.vat_no,onChange:a=>F("vat_no",a.target.value),placeholder:"e.g. VAT123456",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Discount %"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:C.discount_percent,onChange:a=>F("discount_percent",a.target.value),placeholder:"0",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Client / Category"}),(0,b.jsx)("input",{value:C.client,onChange:a=>F("client",a.target.value),placeholder:"e.g. Retail / Wholesale",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Customer Name *"}),(0,b.jsx)("input",{ref:G,value:C.name,onChange:a=>F("name",a.target.value),required:!0,placeholder:"e.g. Aqua Valley Ltd",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Phone"}),(0,b.jsx)("input",{value:C.phone,onChange:a=>F("phone",a.target.value),placeholder:"e.g. 5xxxxxxx",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Email"}),(0,b.jsx)("input",{type:"email",value:C.email,onChange:a=>F("email",a.target.value),placeholder:"e.g. accounts@company.com",className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field rp-field--full",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Address"}),(0,b.jsx)("textarea",{rows:3,value:C.address,onChange:a=>F("address",a.target.value),placeholder:"Street, City, Country",style:{resize:"vertical"},className:"jsx-2933dc1af8e055cb rp-input"})]}),(0,b.jsxs)("label",{className:"jsx-2933dc1af8e055cb rp-field",children:[(0,b.jsx)("span",{className:"jsx-2933dc1af8e055cb rp-label",children:"Opening Balance"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:C.opening_balance,onChange:a=>F("opening_balance",a.target.value),className:"jsx-2933dc1af8e055cb rp-input"}),(0,b.jsx)("div",{style:{marginTop:6,fontWeight:900},className:"jsx-2933dc1af8e055cb rp-muted",children:(j=Number.isFinite(a=Number(C.opening_balance))?a:0,`Rs ${j.toFixed(2)}`)})]})]}),A?(0,b.jsx)("div",{style:{marginTop:12,whiteSpace:"pre-wrap"},className:"jsx-2933dc1af8e055cb rp-note rp-note--warn",children:A}):null,(0,b.jsxs)("div",{style:{marginTop:16,display:"flex",gap:10,flexWrap:"wrap",justifyContent:"flex-end"},className:"jsx-2933dc1af8e055cb",children:[(0,b.jsxs)("button",{type:"button",onClick:I,disabled:y,className:"jsx-2933dc1af8e055cb rp-ui-btn",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-ui-btn__dot"}),"Cancel"]}),(0,b.jsxs)("button",{type:"button",disabled:y,onClick:M,className:"jsx-2933dc1af8e055cb rp-ui-btn rp-ui-btn--danger rp-glow",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:"jsx-2933dc1af8e055cb rp-ui-btn__dot"}),y?"Savingâ€¦":"Create Customer"]})]})]})]}),(0,b.jsxs)("footer",{className:"jsx-2933dc1af8e055cb rp-footer",children:["Â© ",new Date().getFullYear()," Ram Pottery Ltd â€¢ Built by Mobiz.mu"]}),(0,b.jsx)(c.default,{id:"2933dc1af8e055cb",children:".rp-form-grid.jsx-2933dc1af8e055cb{grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;display:grid}@media (width<=780px){.rp-form-grid.jsx-2933dc1af8e055cb{grid-template-columns:1fr}}.rp-field--full.jsx-2933dc1af8e055cb{grid-column:1/-1}"})]})]})]}):null}a.s(["default",()=>j])}];

//# sourceMappingURL=app_customers_new_page_tsx_ef64a830._.js.map