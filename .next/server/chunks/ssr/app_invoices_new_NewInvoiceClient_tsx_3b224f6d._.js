module.exports=[24080,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(24767),f=a.i(66595);let g=[{name:"Mr Koushal",phone:"59193239"},{name:"Mr Akash",phone:"57788884"},{name:"Mr Manish",phone:"57788884"},{name:"Mr Adesh",phone:"58060268"}];function h(a){let b=g.find(b=>b.name===a);return b?.phone||""}function i(a){let b=Number(a??0);return Number.isFinite(b)?b:0}function j(a,b=!1){let c=i(a),d=Math.abs(c%1)>1e-6;return new Intl.NumberFormat("en-US",{minimumFractionDigits:b?2:2*!!d,maximumFractionDigits:2}).format(c)}function k(a){return j(a,!0)}function l(a){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(Math.trunc(i(a)))}function m(){try{return crypto.randomUUID()}catch{return String(Date.now())+"-"+Math.random().toString(16).slice(2)}}function n(a){let b=Math.max(0,i(a.box_qty)),c="PCS"===a.uom?"PCS":"BOX",d="PCS"===c?1:Math.max(1,Math.trunc(i(a.units_per_box)||1)),e="PCS"===c?Math.trunc(b):Math.trunc(b*d),f=Math.max(0,i(a.unit_price_excl_vat)),g=15*(0!==a.vat_rate),h=g/100*f,j=f+h;return{...a,uom:c,units_per_box:d,total_qty:e,vat_rate:g,unit_vat:h,unit_price_incl_vat:j,line_total:e*j}}function o(){return n({id:m(),product_id:null,item_code:"",description:"",uom:"BOX",box_qty:0,units_per_box:1,total_qty:0,vat_rate:15,unit_price_excl_vat:0,unit_vat:0,unit_price_incl_vat:0,line_total:0})}function p(a){let b=String(a||"").replace(/[^\d]/g,"");return b?b.startsWith("230")&&b.length>=11?b:8===b.length?"230"+b:b:""}function q(){let a,q,r=(0,d.useRouter)(),s=(0,d.useSearchParams)().get("duplicate"),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(new Set),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(0),[R,S]=(0,c.useState)(0),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(0),[Z,$]=(0,c.useState)(15),[_,aa]=(0,c.useState)("(Auto when saved)"),[ab,ac]=(0,c.useState)([]);(0,c.useEffect)(()=>{ac(a=>a.map(a=>{if(!a.product_id)return a;let b=z.find(b=>b.id===a.product_id);if(!b)return a;let c=Number(b.price_excl_vat||0),d=Math.max(0,Math.min(100,i(X)));return n({...a,unit_price_excl_vat:c*(1-d/100)})}))},[X,z]);let[ad,ae]=(0,c.useState)(null),[af,ag]=(0,c.useState)(""),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(null),[al,am]=(0,c.useState)(""),[an,ao]=(0,c.useState)(!1),[ap,aq]=(0,c.useState)(""),[ar,as]=(0,c.useState)("COMPANY"),[at,au]=(0,c.useState)(!1);(0,c.useEffect)(()=>{try{let a=localStorage.getItem("rp_user");if(a){let b=JSON.parse(a);ag(String(b?.role||""))}}catch{}},[]),(0,c.useEffect)(()=>{E(new Date().toISOString().slice(0,10)),ac([o()])},[]),(0,c.useEffect)(()=>{let a=!0;return(async()=>{try{let[b,c]=await Promise.all([(0,e.rpFetch)("/api/customers/list",{cache:"no-store"}),(0,e.rpFetch)("/api/products/list",{cache:"no-store"})]),d=b.ok?await b.json():{},f=c.ok?await c.json():{};if(!a)return;y(d.customers||[]),A(f.products||[])}catch{}})(),()=>{a=!1}},[]);let av=(0,c.useMemo)(()=>x.find(a=>a.id===B)||null,[x,B]);(0,c.useMemo)(()=>String(av?.whatsapp||av?.phone||"").replace(/[^\d]/g,"").length>0,[av?.whatsapp,av?.phone]),(0,c.useEffect)(()=>{if(B){let a;T||Q(i(av?.opening_balance??0)),V||S(0),Y(i(av?.discount_percent??0)),!at&&av?.name&&as((a=String(av.name||"").toUpperCase(),/LTD|LIMITED|CO\.|COMPANY|TRADING|ENTERPRISE|INC|LLC/.test(a)?"COMPANY":"CLIENT"))}},[B,av?.opening_balance,av?.discount_percent,av?.name,T,V,at]),(0,c.useEffect)(()=>{function a(){K(!1)}if(J)return window.addEventListener("mousedown",a),()=>window.removeEventListener("mousedown",a)},[J]),(0,c.useEffect)(()=>{let a;if(!s)return;if("ADMIN"!==(a=String(af||"").toUpperCase())&&"MANAGER"!==a){alert("Only Admin / Manager can duplicate invoices."),r.replace("/invoices");return}let b=!0;return(async()=>{try{let a=await (0,e.rpFetch)(`/api/invoices/${s}`,{cache:"no-store"}),c=await a.json();if(!c?.ok||!b)return;let d=c.invoice,f=c.items||[];ae(String(d.invoice_number||s)),C(d.customer_id),G(d.purchase_order_no||"");let g=String(d.sales_rep||"").trim(),h=g?g.split(",").map(a=>a.trim()).filter(Boolean):[];M(h),O(String(d.sales_rep_phone||""));let j=String(d.party_type||d.customer_name_type||"").toUpperCase();("COMPANY"===j||"CLIENT"===j)&&(au(!0),as(j)),Q(0),S(0),U(!1),W(!1);let k=15*(0!==i(d.vat_percent??15));$(k),Y(i(d.discount_percent??0));let l=f.map(a=>n({id:m(),product_id:a.product_id,item_code:a.products?.item_code||"",description:a.description||a.products?.name||"",uom:a.uom||"BOX",box_qty:a.box_qty||0,units_per_box:a.units_per_box||1,total_qty:a.total_qty||0,vat_rate:15*(0!==i(a.vat_rate??15*(a.unit_vat>0))),unit_price_excl_vat:a.unit_price_excl_vat||0,unit_vat:a.unit_vat||0,unit_price_incl_vat:a.unit_price_incl_vat||0,line_total:a.line_total||0}));ac(l.length?l:[o()])}catch{}})(),()=>{b=!1}},[s,af,r]);let aw=(0,c.useMemo)(()=>ab.filter(a=>!!a.product_id),[ab]),ax=(0,c.useMemo)(()=>aw.reduce((a,b)=>a+i(b.total_qty)*i(b.unit_price_excl_vat),0),[aw]),ay=(0,c.useMemo)(()=>aw.reduce((a,b)=>a+i(b.total_qty)*i(b.unit_vat),0),[aw]),az=(0,c.useMemo)(()=>ax+ay,[ax,ay]),aA=(0,c.useMemo)(()=>{let a=Math.max(0,Math.min(100,i(X)));return a<=0?0:Math.max(0,aw.reduce((b,c)=>{let d=i(c.total_qty),e=i(c.unit_price_excl_vat);return b+d*(a>=100?0:e/(1-a/100))},0)+aw.reduce((b,c)=>{let d=i(c.total_qty),e=15*(0!==i(c.vat_rate)),f=i(c.unit_price_excl_vat);return b+e/100*(a>=100?0:f/(1-a/100))*d},0)-az)},[aw,X,az]),aB=(0,c.useMemo)(()=>az+i(P),[az,P]),aC=(0,c.useMemo)(()=>Math.max(0,aB-i(R)),[aB,R]);function aD(a,b){ac(c=>c.map(c=>c.id===a?n({...c,...b}):c))}function aE(){ac(a=>[...a,o()])}(0,c.useEffect)(()=>{let a=()=>w(!1);return window.addEventListener("afterprint",a),()=>window.removeEventListener("afterprint",a)},[]);let aF=(q=(a=String(D||"").trim()).match(/^(\d{4})-(\d{2})-(\d{2})$/))?`${q[3]}/${q[2]}/${q[1]}`:a;function aG(a,b){ac(c=>c.map(c=>{if(c.id!==a)return c;if(!b)return n({...c,product_id:null,item_code:"",description:"",units_per_box:1,unit_price_excl_vat:0,vat_rate:15*(0!==Z),uom:"BOX",box_qty:0});let d=Number(b.price_excl_vat||0),e=Math.max(0,Math.min(100,i(X)));return n({...c,product_id:b.id,item_code:b.item_code||b.sku||"",description:(b.description||b.name||"").trim(),units_per_box:Math.max(1,Number(b.units_per_box||1)),unit_price_excl_vat:d*(1-e/100),vat_rate:15*(0!==Z),uom:"BOX",box_qty:Math.max(1,Math.trunc(Number(c.box_qty||1)))})}))}function aH(){ai(!1),ak(null),am("")}(0,c.useEffect)(()=>{function a(a){if(ah||an||J)return;let b=a.target,c=(b?.tagName||"").toLowerCase();if("Enter"===a.key&&a.shiftKey){a.preventDefault(),aO();return}if("Enter"===a.key&&!a.shiftKey&&"input"!==c&&"textarea"!==c&&"select"!==c){a.preventDefault();let b=document.querySelector(".inv-actions-right .rp-btn");b&&(b.classList.remove("is-pulse"),b.offsetWidth,b.classList.add("is-pulse")),aE(),setTimeout(()=>{let a=Array.from(document.querySelectorAll(".inv-input--qtywide")),b=a[a.length-1];b?.focus(),b?.select?.()},0);return}if((a.ctrlKey||a.metaKey)&&"p"===a.key.toLowerCase()){a.preventDefault(),aP();return}if((a.ctrlKey||a.metaKey)&&"w"===a.key.toLowerCase()){a.preventDefault(),function(){var a;let b,c=p(av?.whatsapp||av?.phone||"");if(!c)return alert("Customer WhatsApp / phone number is missing. Add it in customer profile.");let d=(b=(a={invoiceNo:_,customerName:av?.name||"",total:az,gross:aB,paid:R,balance:aC,date:aF}).paid>=a.gross&&a.gross>0?"PAID âœ…":a.paid>0?"PARTIALLY PAID âœ…":"PENDING",`RAM POTTERY LTD
Invoice: ${a.invoiceNo}
Date: ${a.date}
Customer: ${a.customerName}
Status: ${b}

Total Amount: Rs ${k(a.total)}
Gross Total: Rs ${k(a.gross)}
Paid: Rs ${k(a.paid)}
Balance: Rs ${k(a.balance)}

Thank you.`),e=`https://wa.me/${c}?text=${encodeURIComponent(d)}`;window.open(e,"_blank","noopener,noreferrer")}();return}}return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[ah,an,J,B,ab.length]);let aI=(0,c.useMemo)(()=>{let a=al.trim().toLowerCase();return a?z.filter(b=>{let c=String(b.item_code||"").toLowerCase(),d=String(b.sku||"").toLowerCase(),e=String(b.name||"").toLowerCase(),f=String(b.description||"").toLowerCase();return c.includes(a)||d.includes(a)||e.includes(a)||f.includes(a)}):z},[z,al]),aJ=(0,c.useMemo)(()=>{let a=ap.trim().toLowerCase();return a?x.filter(b=>{let c=String(b.name||"").toLowerCase(),d=String(b.phone||"").toLowerCase(),e=String(b.customer_code||"").toLowerCase(),f=String(b.address||"").toLowerCase();return c.includes(a)||d.includes(a)||e.includes(a)||f.includes(a)}):x},[x,ap]);function aK(){ao(!1),aq("")}function aL(a){let b=a.paidNow>=a.grossTotal&&a.grossTotal>0?"PAID âœ…":a.paidNow>0?"PARTIALLY PAID âœ…":"PENDING";return`RAM POTTERY LTD
Payment update for your invoice

Invoice No: ${a.invoiceNo}
Date: ${a.date}
Customer: ${a.customerName}
Status: ${b}

Amount Paid: Rs ${k(a.paidNow)}
Balance Remaining: Rs ${k(a.balanceRemaining)}

Thank you.`}async function aM(a){let b=await (0,e.rpFetch)(`/api/invoices/${encodeURIComponent(a)}/pdf`,{method:"GET",cache:"no-store"});if(!b.ok)throw Error(await b.text().catch(()=>"")||"Failed to generate PDF");return await b.blob()}async function aN(a,b){let c=await aM(a),d=`Invoice-${a}.pdf`,e=new File([c],d,{type:"application/pdf"}),f=navigator;if(f?.share&&f?.canShare?.({files:[e]}))return void await f.share({title:`Invoice ${a}`,text:b,files:[e]});let g=URL.createObjectURL(c),h=document.createElement("a");h.href=g,h.download=d,document.body.appendChild(h),h.click(),h.remove(),setTimeout(()=>URL.revokeObjectURL(g),2e3),window.open(`https://wa.me/?text=${encodeURIComponent(b)}`,"_blank","noopener,noreferrer"),alert("PDF downloaded. Please attach it in WhatsApp Web / WhatsApp Desktop.")}async function aO(){if(!B)return alert("Please select a customer.");if(!D)return alert("Please select invoice date.");if(!L.length)return alert("Please select at least one sales rep.");if(0===aw.length)return alert("Please add at least one item.");u(!0);try{let a=aw.map(a=>{let b=Math.trunc(i(a.box_qty));if(b<=0)throw Error("Qty must be at least 1 for all items.");let c="PCS"===a.uom?"PCS":"BOX",d="PCS"===c?1:Math.max(1,Math.trunc(i(a.units_per_box)||1));return{product_id:a.product_id,description:a.description||null,uom:c,box_qty:"BOX"===c?b:null,pcs_qty:"PCS"===c?b:null,units_per_box:d,total_qty:"PCS"===c?b:b*d,unit_price_excl_vat:i(a.unit_price_excl_vat),vat_rate:i(a.vat_rate),unit_vat:i(a.unit_vat),unit_price_incl_vat:i(a.unit_price_incl_vat),line_total:i(a.line_total)}}),b=aw.reduce((a,b)=>a+i(b.total_qty)*i(b.unit_price_excl_vat),0),c=aw.reduce((a,b)=>a+i(b.total_qty)*i(b.unit_vat),0),d=i(P),f=i(R),g=b+c+d,j=Math.max(0,g-f),k={customerId:B,invoiceDate:D,purchaseOrderNo:F||null,salesRep:L.join(", "),salesRepPhone:N||L.map(h).filter(Boolean).join(", "),previousBalance:d,amountPaid:f,discountPercent:i(X),discountAmount:i(aA),pricingMode:"LINE_DISCOUNTED",partyType:ar,items:a},l=await (0,e.rpFetch)("/api/invoices/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),m=await l.json().catch(()=>({}));if(!l.ok||!m?.ok)throw Error(m?.error||"Failed to create invoice");let n=String(m.invoiceNumber||"(Saved)");aa(n),f>0&&setTimeout(()=>{let a=aL({invoiceNo:n,customerName:av?.name||"",date:aF,paidNow:f,grossTotal:g,balanceRemaining:j});aN(n,a).catch(a=>alert(a?.message||"Failed to share invoice PDF"))},250),alert(`Invoice saved: ${n}`)}catch(a){alert(a?.message||"Failed to create invoice")}finally{u(!1)}}function aP(){w(!0),document.documentElement.classList.add("rp-printing");let a=()=>{document.documentElement.classList.remove("rp-printing"),w(!1),window.removeEventListener("afterprint",a)};window.addEventListener("afterprint",a),setTimeout(()=>{window.print()},200),setTimeout(a,5e3)}let aQ=(0,c.useMemo)(()=>aw.map((a,b)=>({sn:b+1,item_code:a.item_code,uom:a.uom,box_qty:Math.trunc(i(a.box_qty)),units_per_box:Math.trunc(i(a.units_per_box)),total_qty:Math.trunc(i(a.total_qty)),description:a.description,unit_price_excl_vat:i(a.unit_price_excl_vat),unit_vat:i(a.unit_vat),unit_price_incl_vat:i(a.unit_price_incl_vat),line_total:i(a.line_total)})),[aw]),aR=L.join(", "),aS=N||L.map(h).filter(Boolean).join(", ");return(0,b.jsxs)("div",{className:"inv-page",children:[(0,b.jsxs)("div",{className:"inv-actions inv-screen",children:[(0,b.jsx)("button",{type:"button",className:"rp-btn rp-btn--ghost",onClick:()=>r.back(),children:"â† Back"}),(0,b.jsxs)("div",{className:"inv-actions-right",children:[(0,b.jsx)("button",{type:"button",className:"rp-btn",onClick:aE,children:"+ Add Row"}),(0,b.jsx)("button",{type:"button",className:"rp-btn rp-btn--ghost",disabled:!B,title:"Send payment update on WhatsApp",onClick:()=>{0>=i(R)?alert("Enter an amount paid to send payment update."):function(a){let b=p(av?.whatsapp||av?.phone||"");if(!b)return alert("Customer phone is missing. Add phone number in customer profile.");let c=aL({invoiceNo:_,customerName:av?.name||"",date:aF,paidNow:i(a),grossTotal:aB,balanceRemaining:aC});window.open(`https://wa.me/${b}?text=${encodeURIComponent(c)}`,"_blank","noopener,noreferrer")}(i(R))},children:"WhatsApp"}),(0,b.jsx)("button",{type:"button",className:"rp-btn",onClick:aP,disabled:v,title:"Print A4 invoice",children:v?"Preparingâ€¦":"Print"}),(0,b.jsx)("button",{type:"button",className:"rp-btn rp-btn--primary",onClick:aO,disabled:t,children:t?"Savingâ€¦":"Save Invoice"})]})]}),(0,b.jsx)("div",{className:"inv-screen inv-form-shell",children:(0,b.jsxs)("div",{className:"inv-form-card",children:[(0,b.jsxs)("div",{className:"inv-form-head",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"inv-form-title",children:"New VAT Invoice"}),(0,b.jsx)("div",{className:"inv-form-sub",children:"A4 Print Template Locked (Ram Pottery)"}),ad?(0,b.jsxs)("div",{className:"inv-dup-badge",children:["Duplicated from ",(0,b.jsx)("b",{children:ad})]}):null]}),(0,b.jsxs)("div",{className:"inv-form-meta",children:[(0,b.jsxs)("div",{className:"inv-meta-row",children:[(0,b.jsx)("span",{className:"inv-meta-k",children:"Invoice No"}),(0,b.jsx)("span",{className:"inv-meta-v",children:_})]}),(0,b.jsxs)("div",{className:"inv-meta-row",children:[(0,b.jsx)("span",{className:"inv-meta-k",children:"Date"}),(0,b.jsx)("span",{className:"inv-meta-v",children:D||"â€”"})]})]})]}),(0,b.jsxs)("div",{className:"inv-form-grid",children:[(0,b.jsxs)("div",{className:"inv-field inv-field--type",children:[(0,b.jsx)("label",{children:"Customer Type"}),(0,b.jsxs)("select",{className:"inv-input",value:ar,onChange:a=>{au(!0),as(a.target.value)},children:[(0,b.jsx)("option",{value:"COMPANY",children:"Company Name"}),(0,b.jsx)("option",{value:"CLIENT",children:"Client Name"})]}),(0,b.jsx)("div",{className:"inv-help",children:"Affects the label shown on the invoice header."})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--customer",children:[(0,b.jsx)("label",{children:"COMPANY"===ar?"Company Name":"Client Name"}),(0,b.jsxs)("div",{className:"inv-customer-row",children:[(0,b.jsxs)("select",{className:"inv-input",value:B??"",onChange:a=>{C(a.target.value?Number(a.target.value):null)},children:[(0,b.jsx)("option",{value:"",children:"Selectâ€¦"}),x.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsx)("button",{type:"button",className:"rp-btn rp-btn--ghost inv-search-btn",onClick:function(){aq(""),ao(!0)},title:"Search customer",children:"ðŸ” Search"})]}),(0,b.jsx)("div",{className:"inv-help",children:av?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:av.address})," Â· ",(0,b.jsx)("span",{children:av.phone})]}):(0,b.jsx)("span",{children:"Select a customer (or use Search)"})})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--date",children:[(0,b.jsx)("label",{children:"Invoice Date"}),(0,b.jsx)("input",{className:"inv-input",type:"date",value:D,onChange:a=>E(a.target.value)})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--po",children:[(0,b.jsx)("label",{children:"Purchase Order No (optional)"}),(0,b.jsx)("input",{className:"inv-input",value:F,onChange:a=>G(a.target.value),placeholder:"Optional"})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--reps",children:[(0,b.jsx)("label",{children:"Sales Rep(s)"}),(0,b.jsxs)("div",{className:"inv-rep",children:[(0,b.jsxs)("button",{type:"button",className:"inv-rep-btn",onClick:()=>K(a=>!a),"aria-expanded":J,children:[(0,b.jsx)("div",{className:"inv-rep-chips",children:L.length?L.map(a=>(0,b.jsxs)("span",{className:"inv-chip",children:[a," (",h(a),")",(0,b.jsx)("span",{className:"inv-chip-x",onClick:b=>{b.stopPropagation();let c=L.filter(b=>b!==a);M(c),O(c.map(h).filter(Boolean).join(", "))},title:"Remove",children:"Ã—"})]},a)):(0,b.jsx)("span",{className:"inv-rep-placeholder",children:"Select sales repsâ€¦"})}),(0,b.jsx)("span",{className:"inv-rep-caret",children:"â–¾"})]}),J?(0,b.jsxs)("div",{className:"inv-rep-pop",onMouseDown:a=>a.stopPropagation(),children:[g.map(a=>{let c=L.includes(a.name);return(0,b.jsxs)("button",{type:"button",className:"inv-rep-item"+(c?" is-active":""),onClick:()=>{let b=c?L.filter(b=>b!==a.name):[...L,a.name];M(b),O(b.map(h).filter(Boolean).join(", ")),K(!1)},children:[(0,b.jsx)("span",{className:"inv-rep-name",children:a.name}),(0,b.jsx)("span",{className:"inv-rep-phone",children:a.phone}),(0,b.jsx)("span",{className:"inv-rep-check",children:c?"âœ“":""})]},a.name)}),(0,b.jsx)("div",{className:"inv-rep-hint",children:"Click to select. Click again to remove."})]}):null]})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--vat",children:[(0,b.jsx)("label",{children:"VAT % (applies to all items)"}),(0,b.jsxs)("select",{className:"inv-input",value:Z,onChange:a=>{let b=15*(0!==i(a.target.value));$(b),ac(a=>a.map(a=>n({...a,vat_rate:b})))},children:[(0,b.jsx)("option",{value:15,children:"15%"}),(0,b.jsx)("option",{value:0,children:"0%"})]})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--discount",children:[(0,b.jsx)("label",{children:"Discount % (Party-wise)"}),(0,b.jsx)("input",{className:"inv-input inv-input--right",value:j(X),readOnly:!0}),(0,b.jsx)("div",{className:"inv-help",children:av?(0,b.jsxs)("span",{children:["Auto from ",(0,b.jsx)("b",{children:av.name}),": ",j(i(av.discount_percent??0)),"%"]}):(0,b.jsx)("span",{children:"Auto-fills when you select a customer"})})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--prev",children:[(0,b.jsx)("label",{children:"Previous Balance"}),(0,b.jsx)("input",{className:"inv-input inv-input--right",inputMode:"decimal",value:P,onChange:a=>{U(!0),Q(i(a.target.value))}})]}),(0,b.jsxs)("div",{className:"inv-field inv-field--paid",children:[(0,b.jsx)("label",{children:"Amount Paid"}),(0,b.jsx)("input",{className:"inv-input inv-input--right",inputMode:"decimal",value:R,onChange:a=>{W(!0),S(i(a.target.value))}}),(0,b.jsx)("div",{className:"inv-help",children:"If Amount Paid > 0, WhatsApp prompt opens after Save."})]})]}),(0,b.jsxs)("div",{className:"inv-items",children:[(0,b.jsxs)("div",{className:"inv-items-head",children:[(0,b.jsx)("div",{className:"inv-items-title",children:"Items"}),(0,b.jsx)("div",{className:"inv-items-sub",children:"Matches printed invoice columns (A4)."})]}),(0,b.jsx)("div",{className:"inv-table-wrap",children:(0,b.jsxs)("table",{className:"inv-table inv-table--invoiceCols",children:[(0,b.jsxs)("colgroup",{children:[(0,b.jsx)("col",{style:{width:"4%"}}),(0,b.jsx)("col",{style:{width:"30%"}}),(0,b.jsx)("col",{style:{width:"16%"}}),(0,b.jsx)("col",{style:{width:"8%"}}),(0,b.jsx)("col",{style:{width:"8%"}}),(0,b.jsx)("col",{style:{width:"10%"}}),(0,b.jsx)("col",{style:{width:"6%"}}),(0,b.jsx)("col",{style:{width:"10%"}}),(0,b.jsx)("col",{style:{width:"12%"}}),(0,b.jsx)("col",{style:{width:"4%"}})]}),(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"inv-th inv-th-center",children:"#"}),(0,b.jsx)("th",{className:"inv-th",children:"PRODUCT"}),(0,b.jsx)("th",{className:"inv-th inv-th-center",children:"BOX / PCS"}),(0,b.jsx)("th",{className:"inv-th inv-th-center",children:"UNIT"}),(0,b.jsx)("th",{className:"inv-th inv-th-center",children:"TOTAL QTY"}),(0,b.jsx)("th",{className:"inv-th inv-th-right",children:"UNITÂ EX"}),(0,b.jsx)("th",{className:"inv-th inv-th-right",children:"VAT"}),(0,b.jsx)("th",{className:"inv-th inv-th-right",children:"UNITÂ INC"}),(0,b.jsx)("th",{className:"inv-th inv-th-right",children:"TOTAL"}),(0,b.jsx)("th",{className:"inv-th inv-th-center"})]})}),(0,b.jsx)("tbody",{children:ab.map((a,c)=>{let d=!!a.product_id;return(0,b.jsxs)("tr",{className:H.has(a.id)?"inv-row--removing":"",children:[(0,b.jsx)("td",{className:"inv-td inv-center",children:c+1}),(0,b.jsx)("td",{className:"inv-td",children:(0,b.jsxs)("div",{className:"inv-itemcode-cell--prod",children:[(0,b.jsxs)("select",{className:"inv-input inv-input--prod",value:a.product_id??"",onChange:b=>{let c=b.target.value?Number(b.target.value):null,d=c&&z.find(a=>a.id===c)||null;aG(a.id,d)},children:[(0,b.jsx)("option",{value:"",children:"Selectâ€¦"}),z.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.item_code," â€” ",a.name]},a.id))]}),(0,b.jsx)("button",{type:"button",className:"inv-search-mini",onClick:()=>{ak(a.id),am(""),ai(!0)},title:"Search product",children:"ðŸ”"})]})}),(0,b.jsx)("td",{className:"inv-td inv-center",children:(0,b.jsxs)("div",{className:"inv-boxcell inv-boxcell--premium",children:[(0,b.jsxs)("select",{className:"inv-input inv-input--uom",value:a.uom,onChange:b=>aD(a.id,{uom:b.target.value}),disabled:!d,children:[(0,b.jsx)("option",{value:"BOX",children:"BOX"}),(0,b.jsx)("option",{value:"PCS",children:"PCS"})]}),(0,b.jsx)("input",{className:"inv-input inv-input--qty inv-input--qtywide inv-center",value:a.box_qty,onChange:b=>aD(a.id,{box_qty:i(b.target.value)}),onKeyDown:a=>{if("Enter"!==a.key||a.shiftKey||!d)return;let b=c===ab.length-1,e=Math.trunc(i(a.target.value));b&&e>=1&&(a.preventDefault(),aE(),setTimeout(()=>{let a=Array.from(document.querySelectorAll(".inv-input--qtywide")),b=a[a.length-1];b?.focus(),b?.select?.()},0))},disabled:!d,inputMode:"numeric",placeholder:"0"})]})}),(0,b.jsx)("td",{className:"inv-td inv-center",children:(0,b.jsx)("input",{className:"inv-input inv-center",value:"PCS"===a.uom?"":l(a.units_per_box),readOnly:!0})}),(0,b.jsx)("td",{className:"inv-td inv-center",children:(0,b.jsx)("input",{className:"inv-input inv-center",value:l(a.total_qty),readOnly:!0})}),(0,b.jsx)("td",{className:"inv-td inv-right",children:(0,b.jsx)("input",{className:"inv-input inv-input--right",value:k(a.unit_price_excl_vat),readOnly:!0})}),(0,b.jsx)("td",{className:"inv-td inv-right",children:(0,b.jsx)("input",{className:"inv-input inv-input--right",value:k(a.unit_vat),readOnly:!0})}),(0,b.jsx)("td",{className:"inv-td inv-right",children:(0,b.jsx)("input",{className:"inv-input inv-input--right",value:k(a.unit_price_incl_vat),readOnly:!0})}),(0,b.jsx)("td",{className:"inv-td inv-right",children:(0,b.jsx)("input",{className:"inv-input inv-input--right inv-input--total",value:k(a.line_total),readOnly:!0})}),(0,b.jsx)("td",{className:"inv-td inv-center",children:(0,b.jsx)("button",{type:"button",className:"inv-xmini",onClick:()=>{var b;return b=a.id,void(I(a=>new Set(a).add(b)),window.setTimeout(()=>{ac(a=>a.length<=1?a:a.filter(a=>a.id!==b)),I(a=>{let c=new Set(a);return c.delete(b),c})},190))},title:"Remove row",children:"âœ•"})})]},a.id)})})]})}),(0,b.jsxs)("div",{className:"inv-totalsbar inv-totalsbar--premium",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"Sub Total:"})," ",k(ax)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"VAT:"})," ",k(ay)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"Discount:"})," ",k(aA)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"Total:"})," ",k(az)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"Gross:"})," ",k(aB)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"Balance:"})," ",k(aC)]})]})]}),ah?(0,b.jsx)("div",{className:"inv-modal-backdrop",onMouseDown:aH,children:(0,b.jsxs)("div",{className:"inv-modal",onMouseDown:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"inv-modal-head",children:[(0,b.jsx)("div",{className:"inv-modal-title",children:"Search Product"}),(0,b.jsx)("button",{type:"button",className:"rp-btn rp-btn--ghost",onClick:aH,children:"Close"})]}),(0,b.jsxs)("div",{className:"inv-modal-body",children:[(0,b.jsx)("input",{className:"inv-input",value:al,onChange:a=>am(a.target.value),placeholder:"Search by code, sku, name, descriptionâ€¦",autoFocus:!0}),(0,b.jsx)("div",{className:"inv-modal-list",children:aI.slice(0,150).map(a=>(0,b.jsxs)("button",{type:"button",className:"inv-modal-item",onClick:()=>{aj&&aG(aj,a),aH()},children:[(0,b.jsxs)("div",{className:"inv-modal-item-title",children:[(0,b.jsx)("b",{children:a.item_code||a.sku})," â€” ",a.name]}),(0,b.jsxs)("div",{className:"inv-modal-item-sub",children:["UNIT: ",l(a.units_per_box??1)," Â· Unit Ex: ",k(a.price_excl_vat??0)]})]},a.id))})]})]})}):null,an?(0,b.jsx)("div",{className:"inv-modal-backdrop",onMouseDown:aK,children:(0,b.jsxs)("div",{className:"inv-modal",onMouseDown:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"inv-modal-head",children:[(0,b.jsx)("div",{className:"inv-modal-title",children:"Search Customer"}),(0,b.jsx)("button",{type:"button",className:"rp-btn rp-btn--ghost",onClick:aK,children:"Close"})]}),(0,b.jsxs)("div",{className:"inv-modal-body",children:[(0,b.jsx)("input",{className:"inv-input",value:ap,onChange:a=>aq(a.target.value),placeholder:"Search by name, code, phone, addressâ€¦",autoFocus:!0}),(0,b.jsx)("div",{className:"inv-modal-list",children:aJ.slice(0,200).map(a=>(0,b.jsxs)("button",{type:"button",className:"inv-modal-item",onClick:()=>{C(a.id),aK()},children:[(0,b.jsxs)("div",{className:"inv-modal-item-title",children:[(0,b.jsx)("b",{children:a.name})," ",(0,b.jsxs)("span",{className:"inv-muted",children:["(",a.customer_code,")"]})]}),(0,b.jsxs)("div",{className:"inv-modal-item-sub",children:[a.phone," Â· ",a.address]})]},a.id))})]})]})}):null]})}),(0,b.jsx)("div",{className:"inv-printonly",children:(0,b.jsx)(f.default,{variant:"INVOICE",docNoLabel:"INVOICE NO:",docNoValue:_,dateLabel:"DATE:",dateValue:aF,purchaseOrderLabel:"PURCHASE ORDER NO:",purchaseOrderValue:F||"",salesRepName:aR,salesRepPhone:aS,customer:{name:av?.name||"",address:av?.address||"",phone:av?.phone||"",brn:av?.brn||"",vat_no:av?.vat_no||"",customer_code:av?.customer_code||""},company:{brn:"C17144377",vat_no:"123456789"},items:aQ,totals:{subtotal:ax,vatPercentLabel:"VAT",vat_amount:ay,total_amount:az,previous_balance:P,amount_paid:R,balance_remaining:aC,discount_percent:X,discount_amount:aA},preparedBy:"Manish",deliveredBy:""})})]})}a.s(["default",()=>q])}];

//# sourceMappingURL=app_invoices_new_NewInvoiceClient_tsx_3b224f6d._.js.map