{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/rampotteryhub/src/lib/rpFetch.ts"],"sourcesContent":["// lib/rpFetch.ts\r\n\r\nexport type RpFetchOptions = RequestInit & {\r\n  auth?: boolean; // default true: attach x-rp-user\r\n};\r\n\r\nfunction attachAuthHeader(headers: Headers, options: RpFetchOptions) {\r\n  if (options.auth === false) return;\r\n\r\n  if (typeof window !== \"undefined\") {\r\n    const session = window.localStorage.getItem(\"rp_user\");\r\n    if (session) headers.set(\"x-rp-user\", session);\r\n  }\r\n}\r\n\r\nfunction handleAuthRedirect(res: Response) {\r\n  if (typeof window === \"undefined\") return;\r\n\r\n  if (res.status === 401 || res.status === 403) {\r\n    const next = window.location.pathname + window.location.search;\r\n    window.location.href = `/login?next=${encodeURIComponent(next)}`;\r\n  }\r\n}\r\n\r\n/**\r\n * rpFetch = fetch wrapper that injects x-rp-user and handles 401/403 redirect.\r\n * Returns the native Response (so you can do res.json(), res.text(), etc.)\r\n */\r\nexport async function rpFetch(url: string, options: RpFetchOptions = {}): Promise<Response> {\r\n  const headers = new Headers(options.headers || {});\r\n\r\n  // Default JSON header if body exists (and not FormData)\r\n  const bodyIsFormData =\r\n    typeof FormData !== \"undefined\" && options.body instanceof FormData;\r\n\r\n  if (options.body && !bodyIsFormData && !headers.has(\"Content-Type\")) {\r\n    headers.set(\"Content-Type\", \"application/json\");\r\n  }\r\n\r\n  attachAuthHeader(headers, options);\r\n\r\n  const res = await fetch(url, { ...options, headers });\r\n\r\n  // Redirect on auth issues (client-side)\r\n  handleAuthRedirect(res);\r\n\r\n  return res;\r\n}\r\n\r\n/**\r\n * Convenience helper: returns parsed JSON and throws on non-OK responses.\r\n * Useful for API routes returning { ok, ... } JSON.\r\n */\r\nexport async function rpFetchJson<T = any>(url: string, options: RpFetchOptions = {}): Promise<T> {\r\n  const res = await rpFetch(url, options);\r\n\r\n  let json: any = null;\r\n  try {\r\n    json = await res.json();\r\n  } catch {\r\n    json = null;\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const msg = json?.error || `Request failed (${res.status})`;\r\n    throw new Error(msg);\r\n  }\r\n\r\n  if (json?.ok === false) {\r\n    throw new Error(json?.error || \"Request failed\");\r\n  }\r\n\r\n  return (json ?? {}) as T;\r\n}\r\n\r\n"],"names":[],"mappings":"AAAA,iBAAiB;;;;;;;AAMjB,SAAS,iBAAiB,OAAgB,EAAE,OAAuB;IACjE,IAAI,QAAQ,IAAI,KAAK,OAAO;IAE5B;;AAIF;AAEA,SAAS,mBAAmB,GAAa;IACvC,wCAAmC;;;AAMrC;AAMO,eAAe,QAAQ,GAAW,EAAE,UAA0B,CAAC,CAAC;IACrE,MAAM,UAAU,IAAI,QAAQ,QAAQ,OAAO,IAAI,CAAC;IAEhD,wDAAwD;IACxD,MAAM,iBACJ,OAAO,aAAa,eAAe,QAAQ,IAAI,YAAY;IAE7D,IAAI,QAAQ,IAAI,IAAI,CAAC,kBAAkB,CAAC,QAAQ,GAAG,CAAC,iBAAiB;QACnE,QAAQ,GAAG,CAAC,gBAAgB;IAC9B;IAEA,iBAAiB,SAAS;IAE1B,MAAM,MAAM,MAAM,MAAM,KAAK;QAAE,GAAG,OAAO;QAAE;IAAQ;IAEnD,wCAAwC;IACxC,mBAAmB;IAEnB,OAAO;AACT;AAMO,eAAe,YAAqB,GAAW,EAAE,UAA0B,CAAC,CAAC;IAClF,MAAM,MAAM,MAAM,QAAQ,KAAK;IAE/B,IAAI,OAAY;IAChB,IAAI;QACF,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAM;QACN,OAAO;IACT;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,MAAM,MAAM,SAAS,CAAC,gBAAgB,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;QAC3D,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,MAAM,OAAO,OAAO;QACtB,MAAM,IAAI,MAAM,MAAM,SAAS;IACjC;IAEA,OAAQ,QAAQ,CAAC;AACnB"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/rampotteryhub/src/components/print/RamPotteryDoc.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Image from \"next/image\";\r\nimport React from \"react\";\r\n\r\ntype Party = {\r\n  name?: string | null;\r\n  address?: string | null;\r\n  phone?: string | null;\r\n  brn?: string | null;\r\n  vat_no?: string | null;\r\n  customer_code?: string | null;\r\n};\r\n\r\ntype DocCompany = {\r\n  brn?: string | null;\r\n  vat_no?: string | null;\r\n};\r\n\r\ntype Totals = {\r\n  subtotal?: number | null;\r\n  vatPercentLabel?: string;\r\n  vat_amount?: number | null;\r\n  total_amount?: number | null;\r\n  previous_balance?: number | null;\r\n  amount_paid?: number | null;\r\n  balance_remaining?: number | null;\r\n\r\n  discount_percent?: number | null;\r\n  discount_amount?: number | null;\r\n};\r\n\r\nexport type RamPotteryDocItem = {\r\n  sn: number;\r\n  item_code?: string;\r\n  uom?: string; // BOX / PCS\r\n  box_qty?: number; // box qty or pcs qty\r\n  units_per_box?: number; // unit per box\r\n  total_qty?: number; // total qty\r\n  description?: string;\r\n  unit_price_excl_vat?: number;\r\n  unit_vat?: number;\r\n  unit_price_incl_vat?: number;\r\n  line_total?: number;\r\n};\r\n\r\nexport type RamPotteryDocProps = {\r\n  variant: \"INVOICE\" | \"CREDIT_NOTE\";\r\n\r\n  docNoLabel: string;\r\n  docNoValue: string;\r\n\r\n  dateLabel: string;\r\n  dateValue: string;\r\n\r\n  purchaseOrderLabel?: string;\r\n  purchaseOrderValue?: string;\r\n\r\n  salesRepName?: string;\r\n  salesRepPhone?: string;\r\n\r\n  customer: Party;\r\n  company: DocCompany;\r\n\r\n  items: RamPotteryDocItem[];\r\n\r\n  totals: Totals;\r\n\r\n  preparedBy?: string;\r\n  deliveredBy?: string;\r\n};\r\n\r\nfunction n2(v: any) {\r\n  const x = Number(v ?? 0);\r\n  return Number.isFinite(x) ? x : 0;\r\n}\r\n\r\nfunction fmtMoney(v: any) {\r\n  const x = n2(v);\r\n  // Always 2dp like your screenshot\r\n  return x.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\r\n}\r\n\r\nexport default function RamPotteryDoc(props: RamPotteryDocProps) {\r\n  const {\r\n    variant,\r\n    docNoLabel,\r\n    docNoValue,\r\n    dateLabel,\r\n    dateValue,\r\n    purchaseOrderLabel,\r\n    purchaseOrderValue,\r\n    salesRepName,\r\n    salesRepPhone,\r\n    customer,\r\n    company,\r\n    items,\r\n    totals,\r\n    preparedBy,\r\n    deliveredBy,\r\n  } = props;\r\n\r\n  const docTitle = variant === \"CREDIT_NOTE\" ? \"VAT CREDIT NOTE\" : \"VAT INVOICE\";\r\n\r\n  const showPO = Boolean(purchaseOrderLabel);\r\n  const poVal = purchaseOrderValue || \"\";\r\n\r\n  const brn = company?.brn || \"\";\r\n  const vat = company?.vat_no || \"\";\r\n\r\n  return (\r\n    <div className=\"rpdoc-page\">\r\n      {/* ===== HEADER (logo left, title center) ===== */}\r\n      <div className=\"rpdoc-headerTop\">\r\n        <div className=\"rpdoc-headerTop-left\">\r\n          <Image\r\n            className=\"rpdoc-logoTop\"\r\n            src=\"/images/logo/logo.png\"\r\n            alt=\"Ram Pottery Logo\"\r\n            width={800}\r\n            height={300}\r\n            priority\r\n          />\r\n        </div>\r\n\r\n        <div className=\"rpdoc-headerTop-center\">\r\n          <h1 className=\"rpdoc-titleOneRow\">RAM POTTERY LTD</h1>\r\n\r\n          <div className=\"rpdoc-subTwoRows\">\r\n            <div>MANUFACTURER &amp; IMPORTER OF QUALITY CLAY</div>\r\n            <div>PRODUCTS AND OTHER RELIGIOUS ITEMS</div>\r\n          </div>\r\n\r\n          <div className=\"rpdoc-addrTwoRows\">\r\n            <div>Robert Kennedy Street, Reunion Maurel,</div>\r\n            <div>Petit Raffray - Mauritius</div>\r\n          </div>\r\n\r\n          <div className=\"rpdoc-phonesOneRow\">\r\n            <span>Tel: +230 57788884 +230 58060268 +230 52522844</span>\r\n          </div>\r\n\r\n          <div className=\"rpdoc-mailWebOneRow\">\r\n            <span>Email: info@rampottery.com</span>\r\n            <span className=\"rpdoc-gap\" />\r\n            <span>Web: www.rampottery.com</span>\r\n          </div>\r\n\r\n          <div className=\"rpdoc-docOneRow\">{docTitle}</div>\r\n        </div>\r\n\r\n        <div className=\"rpdoc-headerTop-right\" />\r\n      </div>\r\n\r\n      {/* ===== TOP BOXES ===== */}\r\n      <div className=\"rpdoc-topgrid\">\r\n        {/* CUSTOMER DETAILS */}\r\n        <div className=\"rpdoc-box\">\r\n          <div className=\"rpdoc-box-title\">CUSTOMER DETAILS</div>\r\n          <div className=\"rpdoc-box-body\">\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">Name:</div>\r\n              <div className=\"v\">{customer?.name || \"\"}</div>\r\n            </div>\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">ADDRESS:</div>\r\n              <div className=\"v\">{customer?.address || \"\"}</div>\r\n            </div>\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">Tel:</div>\r\n              <div className=\"v\">{customer?.phone || \"\"}</div>\r\n            </div>\r\n\r\n            <div className=\"rpdoc-row-split\">\r\n              <div className=\"rpdoc-pair\">\r\n                <div className=\"k\">BRN:</div>\r\n                <div className=\"v\">{customer?.brn || \"\"}</div>\r\n              </div>\r\n              <div className=\"rpdoc-pair\">\r\n                <div className=\"k\">VAT No:</div>\r\n                <div className=\"v\">{customer?.vat_no || \"\"}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">CUSTOMER CODE:</div>\r\n              <div className=\"v\">{customer?.customer_code || \"\"}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* BRN/VAT + INVOICE DETAILS */}\r\n        <div className=\"rpdoc-box\">\r\n          <div className=\"rpdoc-box-title\">\r\n            BRN:&nbsp;{brn}&nbsp;|&nbsp;VAT:{vat}\r\n          </div>\r\n          <div className=\"rpdoc-box-body\">\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">{docNoLabel}</div>\r\n              <div className=\"v\">{docNoValue}</div>\r\n            </div>\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">{dateLabel}</div>\r\n              <div className=\"v\">{dateValue}</div>\r\n            </div>\r\n\r\n            {showPO ? (\r\n              <div className=\"rpdoc-row\">\r\n                <div className=\"k\">{purchaseOrderLabel}</div>\r\n                <div className=\"v\">{poVal}</div>\r\n              </div>\r\n            ) : null}\r\n\r\n            <div className=\"rpdoc-row\">\r\n              <div className=\"k\">SALES REP:</div>\r\n              <div className=\"v\">\r\n                {salesRepName || \"\"}\r\n                {salesRepPhone ? (\r\n                  <>\r\n                    <span className=\"rpdoc-gap\" />\r\n                    <span className=\"rpdoc-red\">Tel: {salesRepPhone}</span>\r\n                  </>\r\n                ) : null}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ===== ITEMS TABLE ===== */}\r\n      <table className=\"rpdoc-table2\">\r\n        <colgroup>\r\n          <col style={{ width: \"4%\" }} />\r\n          <col style={{ width: \"10%\" }} />\r\n          <col style={{ width: \"6%\" }} />\r\n          <col style={{ width: \"8%\" }} />\r\n          <col style={{ width: \"9%\" }} />\r\n          <col style={{ width: \"29%\" }} />\r\n          <col style={{ width: \"10%\" }} />\r\n          <col style={{ width: \"6%\" }} />\r\n          <col style={{ width: \"10%\" }} />\r\n          <col style={{ width: \"8%\" }} />\r\n        </colgroup>\r\n        <thead>\r\n          <tr>\r\n            <th>SN</th>\r\n            <th>ITEM CODE</th>\r\n            <th>BOX</th>\r\n            <th>UNIT PER BOX</th>\r\n            <th>TOTAL QTY</th>\r\n            <th>DESCRIPTION</th>\r\n            <th>UNIT PRICE<br />(EXCL VAT)</th>\r\n            <th>VAT</th>\r\n            <th>UNIT PRICE<br />(INCL VAT)</th>\r\n            <th>TOTAL AMOUNT<br />(INCL VAT)</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {(items?.length ? items : []).map((it) => {\r\n            const uom = (it.uom || \"BOX\").toUpperCase();\r\n            const boxQty = n2(it.box_qty);\r\n            const upb = n2(it.units_per_box);\r\n            const totalQty = n2(it.total_qty);\r\n\r\n            return (\r\n              <tr key={it.sn}>\r\n                <td className=\"c\">{it.sn}</td>\r\n                <td className=\"c\">{it.item_code || \"\"}</td>\r\n                <td className=\"c\">{uom}</td>\r\n                <td className=\"c\">{upb ? String(upb) : \"\"}</td>\r\n                <td className=\"c\">{totalQty ? String(totalQty) : String(boxQty || 0)}</td>\r\n                <td className=\"l desc\">{it.description || \"\"}</td>\r\n                <td className=\"r\">{fmtMoney(it.unit_price_excl_vat)}</td>\r\n                <td className=\"r\">{fmtMoney(it.unit_vat)}</td>\r\n                <td className=\"r\">{fmtMoney(it.unit_price_incl_vat)}</td>\r\n                <td className=\"r\">{fmtMoney(it.line_total)}</td>\r\n              </tr>\r\n            );\r\n          })}\r\n\r\n          {/* If you want fixed height like the screenshot even with few lines */}\r\n          {items.length < 6\r\n            ? Array.from({ length: 6 - items.length }).map((_, i) => (\r\n                <tr key={`blank-${i}`}>\r\n                  <td className=\"c\">&nbsp;</td>\r\n                  <td className=\"c\">&nbsp;</td>\r\n                  <td className=\"c\">&nbsp;</td>\r\n                  <td className=\"c\">&nbsp;</td>\r\n                  <td className=\"c\">&nbsp;</td>\r\n                  <td className=\"l desc\">&nbsp;</td>\r\n                  <td className=\"r\">&nbsp;</td>\r\n                  <td className=\"r\">&nbsp;</td>\r\n                  <td className=\"r\">&nbsp;</td>\r\n                  <td className=\"r\">&nbsp;</td>\r\n                </tr>\r\n              ))\r\n            : null}\r\n        </tbody>\r\n      </table>\r\n\r\n      {/* ===== NOTES + TOTALS ===== */}\r\n      <div className=\"rpdoc-bottomgrid\">\r\n        <div className=\"rpdoc-notes\">\r\n          <div className=\"rpdoc-notes-title\">Note:</div>\r\n          <ul>\r\n            <li>Goods once sold cannot be returned or exchanged.</li>\r\n            <li>For any other manufacturing defects, must provide this invoice for a refund or exchange.</li>\r\n            <li>\r\n              Customer must verify that the quantity of goods conforms with their invoice; otherwise, we will not be\r\n              responsible after delivery\r\n            </li>\r\n            <li>\r\n              Interest of <span className=\"redStrong\">1%</span> above the bank rate will be charged on sum due if not\r\n              settled within <span className=\"redStrong\">30 days</span>.\r\n            </li>\r\n            <li>All cheques to be issued on RAM POTTERY LTD.</li>\r\n            <li>Bank transfer to: 000 44 570 46 59 MCB Bank</li>\r\n          </ul>\r\n        </div>\r\n\r\n        <div className=\"rpdoc-totals\">\r\n          <div className=\"trow\">\r\n            <div>SUB TOTAL</div>\r\n            <div className=\"money\">{fmtMoney(totals?.subtotal)}</div>\r\n          </div>\r\n          <div className=\"trow\">\r\n            <div>{(totals?.vatPercentLabel || \"VAT\").toUpperCase()}</div>\r\n            <div className=\"money\">{fmtMoney(totals?.vat_amount)}</div>\r\n          </div>\r\n          <div className=\"trow\">\r\n            <div>TOTAL AMOUNT</div>\r\n            <div className=\"money\">{fmtMoney(totals?.total_amount)}</div>\r\n          </div>\r\n          <div className=\"trow\">\r\n            <div>PREVIOUS BALANCE</div>\r\n            <div className=\"money\">{fmtMoney(totals?.previous_balance)}</div>\r\n          </div>\r\n          <div className=\"trow\">\r\n            <div>GROSS TOTAL</div>\r\n            <div className=\"money\">{fmtMoney(totals?.balance_remaining ?? totals?.total_amount)}</div>\r\n          </div>\r\n          <div className=\"trow\">\r\n            <div>AMOUNT PAID</div>\r\n            <div className=\"money\">{fmtMoney(totals?.amount_paid)}</div>\r\n          </div>\r\n          <div className=\"trow\">\r\n            <div>BALANCE REMAINING</div>\r\n            <div className=\"money\">{fmtMoney(totals?.balance_remaining)}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ===== SIGNATURES ===== */}\r\n      <div className=\"rpdoc-sign\">\r\n        <div className=\"signcol\">\r\n          <div className=\"line\" />\r\n          <div className=\"label\">Signature</div>\r\n          <div className=\"meta\">Prepared by: {preparedBy || \"\"}</div>\r\n        </div>\r\n\r\n        <div className=\"signcol\">\r\n          <div className=\"line\" />\r\n          <div className=\"label\">Signature</div>\r\n          <div className=\"meta\">Delivered by: {deliveredBy || \"\"}</div>\r\n        </div>\r\n\r\n        <div className=\"signcol\">\r\n          <div className=\"line\" />\r\n          <div className=\"label\">Customer Signature</div>\r\n          <div className=\"meta\">\r\n            Customer Name: __________________\r\n            <br />\r\n            <i>Please verify before sign</i>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* âœ… IMPORTANT: keep the same bottom spacing as screenshot, but NO red thank-you bar */}\r\n      <div className=\"rpdoc-footerSpace\" />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1435, "column": 0}, "map": {"version":3,"sources":["file:///C:/Dev/rampotteryhub/app/invoices/new/NewInvoiceClient.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { rpFetch } from \"@/lib/rpFetch\";\r\nimport RamPotteryDoc from \"@/components/print/RamPotteryDoc\";\r\n\r\ntype CustomerRow = {\r\n  id: number;\r\n  name: string;\r\n  address: string;\r\n  phone: string;\r\n  whatsapp?: string;\r\n  brn?: string;\r\n  vat_no?: string;\r\n  customer_code: string;\r\n  opening_balance?: number | null;\r\n  discount_percent?: number | null;\r\n};\r\n\r\ntype ProductRow = {\r\n  id: number;\r\n  item_code: string;\r\n  sku: string;\r\n  name: string;\r\n  description: string;\r\n  units_per_box: number | null;\r\n\r\n  // âœ… MUST MATCH API\r\n  price_excl_vat: number;\r\n  vat_rate: number;\r\n};\r\n\r\ntype Uom = \"BOX\" | \"PCS\";\r\n\r\ntype InvoiceLine = {\r\n  id: string;\r\n  product_id: number | null;\r\n\r\n  item_code: string;\r\n  description: string;\r\n\r\n  uom: Uom;\r\n  box_qty: number; // qty input (box qty or pcs qty depending on uom)\r\n  units_per_box: number;\r\n  total_qty: number;\r\n\r\n  vat_rate: number; // 0 or 15\r\n  unit_price_excl_vat: number;\r\n  unit_vat: number;\r\n  unit_price_incl_vat: number;\r\n  line_total: number;\r\n};\r\n\r\n/* ===========================\r\n   âœ… Sales reps (premium picker)\r\n   =========================== */\r\nconst SALES_REPS = [\r\n  { name: \"Mr Koushal\", phone: \"59193239\" },\r\n  { name: \"Mr Akash\", phone: \"57788884\" },\r\n  { name: \"Mr Manish\", phone: \"57788884\" },\r\n  { name: \"Mr Adesh\", phone: \"58060268\" },\r\n] as const;\r\n\r\ntype SalesRepName = (typeof SALES_REPS)[number][\"name\"];\r\n\r\nfunction repPhoneByName(name: string) {\r\n  const r = SALES_REPS.find((x) => x.name === name);\r\n  return r?.phone || \"\";\r\n}\r\n\r\nfunction n2(v: any) {\r\n  const x = Number(v ?? 0);\r\n  return Number.isFinite(x) ? x : 0;\r\n}\r\n\r\n/** âœ… Commas + decimals only when needed (or force2 for money) */\r\nfunction fmtNumber(v: any, force2 = false) {\r\n  const x = n2(v);\r\n  const hasDecimals = Math.abs(x % 1) > 0.000001;\r\n  const minFrac = force2 ? 2 : hasDecimals ? 2 : 0;\r\n  const maxFrac = 2;\r\n  return new Intl.NumberFormat(\"en-US\", {\r\n    minimumFractionDigits: minFrac,\r\n    maximumFractionDigits: maxFrac,\r\n  }).format(x);\r\n}\r\n\r\nfunction money(v: any) {\r\n  // money values always show .00\r\n  return fmtNumber(v, true);\r\n}\r\n\r\nfunction intFmt(v: any) {\r\n  return new Intl.NumberFormat(\"en-US\", { maximumFractionDigits: 0 }).format(\r\n    Math.trunc(n2(v))\r\n  );\r\n}\r\n\r\nfunction uid() {\r\n  try {\r\n    return crypto.randomUUID();\r\n  } catch {\r\n    return String(Date.now()) + \"-\" + Math.random().toString(16).slice(2);\r\n  }\r\n}\r\n\r\nfunction clampPct(v: any) {\r\n  const x = n2(v);\r\n  return Math.max(0, Math.min(100, x));\r\n}\r\n\r\nfunction recalc(row: InvoiceLine): InvoiceLine {\r\n  const qtyInput = Math.max(0, n2(row.box_qty));\r\n  const uom: Uom = row.uom === \"PCS\" ? \"PCS\" : \"BOX\";\r\n  const upb = uom === \"PCS\" ? 1 : Math.max(1, Math.trunc(n2(row.units_per_box) || 1));\r\n\r\n  const totalQty = uom === \"PCS\" ? Math.trunc(qtyInput) : Math.trunc(qtyInput * upb);\r\n\r\n  const unitEx = Math.max(0, n2(row.unit_price_excl_vat)); // âœ… already discounted if needed\r\n  const rate = row.vat_rate === 0 ? 0 : 15;\r\n\r\n  const unitVat = unitEx * (rate / 100);\r\n  const unitInc = unitEx + unitVat;\r\n\r\n  return {\r\n    ...row,\r\n    uom,\r\n    units_per_box: upb,\r\n    total_qty: totalQty,\r\n    vat_rate: rate,\r\n    unit_vat: unitVat,\r\n    unit_price_incl_vat: unitInc,\r\n    line_total: totalQty * unitInc,\r\n  };\r\n}\r\n\r\nfunction blankLine(): InvoiceLine {\r\n  return recalc({\r\n    id: uid(),\r\n    product_id: null,\r\n    item_code: \"\",\r\n    description: \"\",\r\n    uom: \"BOX\",\r\n    box_qty: 0,\r\n    units_per_box: 1,\r\n    total_qty: 0,\r\n    vat_rate: 15,\r\n    unit_price_excl_vat: 0,\r\n    unit_vat: 0,\r\n    unit_price_incl_vat: 0,\r\n    line_total: 0,\r\n  });\r\n}\r\n\r\nfunction roleUpper(r?: string) {\r\n  return String(r || \"\").toUpperCase();\r\n}\r\nfunction canDuplicate(role?: string) {\r\n  const r = roleUpper(role);\r\n  return r === \"ADMIN\" || r === \"MANAGER\";\r\n}\r\n\r\nfunction formatDDMMYYYY(v: any) {\r\n  const s = String(v || \"\").trim();\r\n  const m = s.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\r\n  if (m) return `${m[3]}/${m[2]}/${m[1]}`;\r\n  return s;\r\n}\r\n\r\n/* ===========================\r\n   âœ… Company vs Client selector\r\n   =========================== */\r\nfunction guessPartyType(name: string) {\r\n  const s = String(name || \"\").toUpperCase();\r\n  return /LTD|LIMITED|CO\\.|COMPANY|TRADING|ENTERPRISE|INC|LLC/.test(s) ? \"COMPANY\" : \"CLIENT\";\r\n}\r\n\r\nfunction normalizeMuPhone(phone: string) {\r\n  // returns digits only (Mauritius default +230)\r\n  const digits = String(phone || \"\").replace(/[^\\d]/g, \"\");\r\n  if (!digits) return \"\";\r\n  // already has country code\r\n  if (digits.startsWith(\"230\") && digits.length >= 11) return digits;\r\n  // local 8-digit number\r\n  if (digits.length === 8) return \"230\" + digits;\r\n  return digits;\r\n}\r\n\r\nexport default function NewInvoiceClient() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const duplicateId = searchParams.get(\"duplicate\");\r\n\r\n  const [saving, setSaving] = useState(false);\r\n  const [printing, setPrinting] = useState(false);\r\n\r\n  const [customers, setCustomers] = useState<CustomerRow[]>([]);\r\n  const [products, setProducts] = useState<ProductRow[]>([]);\r\n\r\n  const [customerId, setCustomerId] = useState<number | null>(null);\r\n  const [invoiceDate, setInvoiceDate] = useState<string>(\"\");\r\n  const [purchaseOrderNo, setPurchaseOrderNo] = useState(\"\");\r\n\r\n  const [removingIds, setRemovingIds] = useState<Set<string>>(new Set());\r\n\r\n  // âœ… reps picker\r\n  const [repOpen, setRepOpen] = useState(false);\r\n  const [salesReps, setSalesReps] = useState<SalesRepName[]>([]);\r\n  const [salesRepPhones, setSalesRepPhones] = useState<string>(\"\");\r\n\r\n  const [previousBalance, setPreviousBalance] = useState<number>(0);\r\n  const [amountPaid, setAmountPaid] = useState<number>(0);\r\n\r\n  const [prevTouched, setPrevTouched] = useState(false);\r\n  const [paidTouched, setPaidTouched] = useState(false);\r\n\r\n  // âœ… party-wise discount MUST be automatic\r\n  const [discountPercent, setDiscountPercent] = useState<number>(0);\r\n\r\n  const [vatPercent, setVatPercent] = useState<number>(15);\r\n\r\n  const [invoiceNumber, setInvoiceNumber] = useState<string>(\"(Auto when saved)\");\r\n  const [lines, setLines] = useState<InvoiceLine[]>([]);\r\n\r\n  useEffect(() => {\r\n  setLines((prev) =>\r\n    prev.map((r) => {\r\n      if (!r.product_id) return r;\r\n      const p = products.find((x) => x.id === r.product_id);\r\n      if (!p) return r;\r\n\r\n      const baseEx = Number(p.price_excl_vat || 0);\r\n      const disc = Math.max(0, Math.min(100, n2(discountPercent)));\r\n      const discountedEx = baseEx * (1 - disc / 100);\r\n\r\n      return recalc({ ...r, unit_price_excl_vat: discountedEx } as InvoiceLine);\r\n    })\r\n  );\r\n}, [discountPercent, products]);\r\n\r\n\r\n  const [dupFromNo, setDupFromNo] = useState<string | null>(null);\r\n  const [role, setRole] = useState<string>(\"\");\r\n\r\n  // Product search modal\r\n  const [searchOpen, setSearchOpen] = useState(false);\r\n  const [searchRowId, setSearchRowId] = useState<string | null>(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n\r\n  // Customer search modal\r\n  const [custSearchOpen, setCustSearchOpen] = useState(false);\r\n  const [custSearchTerm, setCustSearchTerm] = useState(\"\");\r\n\r\n  // âœ… Customer Name Type (Company / Client)\r\n  const [customerNameType, setCustomerNameType] = useState<\"COMPANY\" | \"CLIENT\">(\"COMPANY\");\r\n  const [customerNameTypeTouched, setCustomerNameTypeTouched] = useState(false);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const raw = localStorage.getItem(\"rp_user\");\r\n      if (raw) {\r\n        const u = JSON.parse(raw);\r\n        setRole(String(u?.role || \"\"));\r\n      }\r\n    } catch {}\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setInvoiceDate(new Date().toISOString().slice(0, 10));\r\n    setLines([blankLine()]);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n    (async () => {\r\n      try {\r\n        const [cRes, pRes] = await Promise.all([\r\n          rpFetch(\"/api/customers/list\", { cache: \"no-store\" }),\r\n          rpFetch(\"/api/products/list\", { cache: \"no-store\" }),\r\n        ]);\r\n\r\n        const cJson = cRes.ok ? await cRes.json() : {};\r\n        const pJson = pRes.ok ? await pRes.json() : {};\r\n\r\n        if (!alive) return;\r\n        setCustomers(cJson.customers || []);\r\n        setProducts(pJson.products || []);\r\n      } catch {}\r\n    })();\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, []);\r\n\r\n \r\nconst customer = useMemo(\r\n  () => customers.find((c) => c.id === customerId) || null,\r\n  [customers, customerId]\r\n);\r\n\r\nconst hasWhatsApp = useMemo(() => {\r\n  const raw = customer?.whatsapp || customer?.phone || \"\";\r\n  const d = String(raw).replace(/[^\\d]/g, \"\");\r\n  return d.length > 0;\r\n}, [customer?.whatsapp, customer?.phone]);\r\n\r\n\r\n{hasWhatsApp ? (\r\n  <button\r\n    type=\"button\"\r\n    className=\"rp-btn rp-btn--ghost\"\r\n    disabled={!customerId}\r\n    title=\"Send payment update on WhatsApp\"\r\n    onClick={() => {\r\n      if (n2(amountPaid) <= 0) {\r\n        alert(\"Enter an amount paid to send payment update.\");\r\n        return;\r\n      }\r\n      openWhatsAppPaymentUpdate(n2(amountPaid));\r\n    }}\r\n  >\r\n    WhatsApp\r\n  </button>\r\n) : null}\r\n\r\n\r\n \r\n  // customer-wise auto-fill (discount is always automatic)\r\n  useEffect(() => {\r\n    if (!customerId) return;\r\n\r\n    if (!prevTouched) setPreviousBalance(n2(customer?.opening_balance ?? 0));\r\n    if (!paidTouched) setAmountPaid(0);\r\n\r\n    // âœ… ALWAYS auto party discount\r\n    setDiscountPercent(n2(customer?.discount_percent ?? 0));\r\n\r\n    // âœ… auto company/client from customer name (if user didnâ€™t touch selector)\r\n    if (!customerNameTypeTouched && customer?.name) {\r\n\r\n      setCustomerNameType(guessPartyType(customer.name));\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [\r\n    customerId,\r\n    customer?.opening_balance,\r\n    customer?.discount_percent,\r\n    customer?.name,\r\n    prevTouched,\r\n    paidTouched,\r\n    customerNameTypeTouched,\r\n  ]);\r\n\r\n  // Close rep popup on outside click\r\n  useEffect(() => {\r\n    function close() {\r\n      setRepOpen(false);\r\n    }\r\n    if (!repOpen) return;\r\n    window.addEventListener(\"mousedown\", close);\r\n    return () => window.removeEventListener(\"mousedown\", close);\r\n  }, [repOpen]);\r\n\r\n  // DUPLICATE PREFILL\r\n  useEffect(() => {\r\n    if (!duplicateId) return;\r\n\r\n    if (!canDuplicate(role)) {\r\n      alert(\"Only Admin / Manager can duplicate invoices.\");\r\n      router.replace(\"/invoices\");\r\n      return;\r\n    }\r\n\r\n    let alive = true;\r\n\r\n    (async () => {\r\n      try {\r\n        // âœ… IMPORTANT: your working API file is /api/invoices/[id]\r\n        const res = await rpFetch(`/api/invoices/${duplicateId}`, { cache: \"no-store\" });\r\n        const json = await res.json();\r\n        if (!json?.ok || !alive) return;\r\n\r\n        const inv = json.invoice;\r\n        const items = json.items || [];\r\n\r\n        setDupFromNo(String(inv.invoice_number || duplicateId));\r\n\r\n        setCustomerId(inv.customer_id);\r\n        setPurchaseOrderNo(inv.purchase_order_no || \"\");\r\n\r\n        const repText = String(inv.sales_rep || \"\").trim();\r\n        const repList = repText\r\n          ? repText.split(\",\").map((s: string) => s.trim()).filter(Boolean)\r\n          : [];\r\n        setSalesReps(repList as SalesRepName[]);\r\n        setSalesRepPhones(String(inv.sales_rep_phone || \"\"));\r\n\r\n        const invType = String(inv.party_type || inv.customer_name_type || \"\").toUpperCase();\r\n        if (invType === \"COMPANY\" || invType === \"CLIENT\") {\r\n          setCustomerNameTypeTouched(true);\r\n          setCustomerNameType(invType as any);\r\n        }\r\n\r\n        setPreviousBalance(0);\r\n        setAmountPaid(0);\r\n        setPrevTouched(false);\r\n        setPaidTouched(false);\r\n\r\n        const invVat = n2(inv.vat_percent ?? 15) === 0 ? 0 : 15;\r\n        setVatPercent(invVat);\r\n\r\n        // âœ… discount auto from customer anyway, but keep what invoice had if any\r\n        setDiscountPercent(n2(inv.discount_percent ?? 0));\r\n\r\n        const cloned = items.map((it: any) =>\r\n          recalc({\r\n            id: uid(),\r\n            product_id: it.product_id,\r\n            item_code: it.products?.item_code || \"\",\r\n            description: it.description || it.products?.name || \"\",\r\n            uom: it.uom || \"BOX\",\r\n            box_qty: it.box_qty || 0,\r\n            units_per_box: it.units_per_box || 1,\r\n            total_qty: it.total_qty || 0,\r\n            vat_rate: n2(it.vat_rate ?? (it.unit_vat > 0 ? 15 : 0)) === 0 ? 0 : 15,\r\n            unit_price_excl_vat: it.unit_price_excl_vat || 0,\r\n            unit_vat: it.unit_vat || 0,\r\n            unit_price_incl_vat: it.unit_price_incl_vat || 0,\r\n            line_total: it.line_total || 0,\r\n          })\r\n        );\r\n\r\n        setLines(cloned.length ? cloned : [blankLine()]);\r\n      } catch {}\r\n    })();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [duplicateId, role, router]);\r\n\r\n  const realLines = useMemo(() => lines.filter((l) => !!l.product_id), [lines]);\r\n\r\n  const subtotalEx = useMemo(\r\n    () => realLines.reduce((sum, r) => sum + n2(r.total_qty) * n2(r.unit_price_excl_vat), 0),\r\n    [realLines]\r\n  );\r\n  const vatAmount = useMemo(\r\n    () => realLines.reduce((sum, r) => sum + n2(r.total_qty) * n2(r.unit_vat), 0),\r\n    [realLines]\r\n  );\r\n  \r\n\r\n  const totalAmount = useMemo(() => subtotalEx + vatAmount, [subtotalEx, vatAmount]);\r\n\r\n// Optional: show discount amount as \"saved amount\" for display (compare with original)\r\nconst discountAmount = useMemo(() => {\r\n  const dp = Math.max(0, Math.min(100, n2(discountPercent)));\r\n  if (dp <= 0) return 0;\r\n\r\n  // Rebuild \"original total\" by reversing discount from each unitEx\r\n  const originalSubtotalEx = realLines.reduce((sum, r) => {\r\n    const qty = n2(r.total_qty);\r\n    const discountedUnitEx = n2(r.unit_price_excl_vat);\r\n    const originalUnitEx = dp >= 100 ? 0 : discountedUnitEx / (1 - dp / 100);\r\n    return sum + qty * originalUnitEx;\r\n  }, 0);\r\n\r\n  const originalVat = realLines.reduce((sum, r) => {\r\n    const qty = n2(r.total_qty);\r\n    const rate = n2(r.vat_rate) === 0 ? 0 : 15;\r\n    const discountedUnitEx = n2(r.unit_price_excl_vat);\r\n    const originalUnitEx = dp >= 100 ? 0 : discountedUnitEx / (1 - dp / 100);\r\n    return sum + qty * (originalUnitEx * (rate / 100));\r\n  }, 0);\r\n\r\n  const originalTotal = originalSubtotalEx + originalVat;\r\n  const discountedTotal = totalAmount;\r\n\r\n  return Math.max(0, originalTotal - discountedTotal);\r\n}, [realLines, discountPercent, totalAmount]);\r\n\r\n\r\n  const grossTotal = useMemo(() => totalAmount + n2(previousBalance), [totalAmount, previousBalance]);\r\n\r\n  const balanceRemaining = useMemo(\r\n    () => Math.max(0, grossTotal - n2(amountPaid)),\r\n    [grossTotal, amountPaid]\r\n  );\r\n\r\n  function setLine(id: string, patch: Partial<InvoiceLine>) {\r\n  setLines((prev) =>\r\n    prev.map((r) => (r.id === id ? recalc({ ...r, ...patch } as InvoiceLine) : r))\r\n  );\r\n}\r\n\r\n  function addRow() {\r\n    setLines((prev) => [...prev, blankLine()]);\r\n  }\r\n\r\n  function removeRow(id: string) {\r\n    setRemovingIds((prev) => new Set(prev).add(id));\r\n\r\n    window.setTimeout(() => {\r\n      setLines((prev) => (prev.length <= 1 ? prev : prev.filter((r) => r.id !== id)));\r\n      setRemovingIds((prev) => {\r\n        const next = new Set(prev);\r\n        next.delete(id);\r\n        return next;\r\n      });\r\n    }, 190); // matches CSS animation\r\n  }\r\n\r\n  useEffect(() => {\r\n    const done = () => setPrinting(false);\r\n    window.addEventListener(\"afterprint\", done);\r\n    return () => window.removeEventListener(\"afterprint\", done);\r\n  }, []);\r\n\r\n  \r\n  const invoiceDatePrint = formatDDMMYYYY(invoiceDate);\r\n\r\n\r\n  function openWhatsApp() {\r\n  const phone = normalizeMuPhone(customer?.whatsapp || customer?.phone || \"\");\r\n\r\n  if (!phone) {\r\n    alert(\"Customer WhatsApp / phone number is missing. Add it in customer profile.\");\r\n    return;\r\n  }\r\n\r\n  const text = buildWhatsAppText({\r\n    invoiceNo: invoiceNumber,\r\n    customerName: customer?.name || \"\",\r\n    total: totalAmount,\r\n    gross: grossTotal,\r\n    paid: amountPaid,\r\n    balance: balanceRemaining,\r\n    date: invoiceDatePrint,\r\n  });\r\n\r\n  const url = `https://wa.me/${phone}?text=${encodeURIComponent(text)}`;\r\n  window.open(url, \"_blank\", \"noopener,noreferrer\");\r\n}\r\n\r\n\r\n  useEffect(() => {\r\n    function onKeyDown(e: KeyboardEvent) {\r\n      // ignore if modal/popup open\r\n      if (searchOpen || custSearchOpen || repOpen) return;\r\n\r\n      const el = e.target as HTMLElement | null;\r\n      const tag = (el?.tagName || \"\").toLowerCase();\r\n      const isTyping = tag === \"input\" || tag === \"textarea\" || tag === \"select\";\r\n\r\n      // SHIFT+ENTER => SAVE (even if typing)\r\n      if (e.key === \"Enter\" && e.shiftKey) {\r\n        e.preventDefault();\r\n        onSave();\r\n        return;\r\n      }\r\n\r\n      // ENTER => add row (only when NOT typing)\r\n      if (e.key === \"Enter\" && !e.shiftKey && !isTyping) {\r\n        e.preventDefault();\r\n\r\n        // pulse button (optional)\r\n        const addBtn = document.querySelector(\".inv-actions-right .rp-btn\") as\r\n          | HTMLButtonElement\r\n          | null;\r\n        if (addBtn) {\r\n          addBtn.classList.remove(\"is-pulse\");\r\n          void addBtn.offsetWidth;\r\n          addBtn.classList.add(\"is-pulse\");\r\n        }\r\n\r\n        addRow();\r\n\r\n        // focus next row qty input\r\n        setTimeout(() => {\r\n          const qtyInputs = Array.from(\r\n            document.querySelectorAll<HTMLInputElement>(\".inv-input--qtywide\")\r\n          );\r\n          const last = qtyInputs[qtyInputs.length - 1];\r\n          last?.focus();\r\n          last?.select?.();\r\n        }, 0);\r\n\r\n        return;\r\n      }\r\n\r\n      // CTRL+P => PRINT\r\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === \"p\") {\r\n        e.preventDefault();\r\n        onPrint();\r\n        return;\r\n      }\r\n\r\n      // CTRL+W => WhatsApp (prevent tab close)\r\n      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === \"w\") {\r\n        e.preventDefault();\r\n        openWhatsApp();\r\n        return;\r\n      }\r\n    }\r\n\r\n    window.addEventListener(\"keydown\", onKeyDown);\r\n    return () => window.removeEventListener(\"keydown\", onKeyDown);\r\n  }, [searchOpen, custSearchOpen, repOpen, customerId, lines.length]);\r\n\r\nfunction applyProductToRow(rowId: string, product: ProductRow | null) {\r\n  setLines((prev) =>\r\n    prev.map((r) => {\r\n      if (r.id !== rowId) return r;\r\n\r\n      if (!product) {\r\n        return recalc({\r\n          ...r,\r\n          product_id: null,\r\n          item_code: \"\",\r\n          description: \"\",\r\n          units_per_box: 1,\r\n          unit_price_excl_vat: 0,\r\n          vat_rate: vatPercent === 0 ? 0 : 15,\r\n          uom: \"BOX\",\r\n          box_qty: 0,\r\n        });\r\n      }\r\n\r\n      const baseEx = Number(product.price_excl_vat || 0);\r\n      const disc = Math.max(0, Math.min(100, n2(discountPercent)));\r\n      const discountedEx = baseEx * (1 - disc / 100);\r\n\r\n      return recalc({\r\n        ...r,\r\n        product_id: product.id,\r\n        item_code: product.item_code || product.sku || \"\",\r\n        description: (product.description || product.name || \"\").trim(),\r\n        units_per_box: Math.max(1, Number(product.units_per_box || 1)),\r\n        unit_price_excl_vat: discountedEx,\r\n        vat_rate: vatPercent === 0 ? 0 : 15,\r\n        uom: \"BOX\",\r\n        box_qty: Math.max(1, Math.trunc(Number(r.box_qty || 1))),\r\n      });\r\n    })\r\n  );\r\n}\r\n\r\n\r\n  function openSearchForRow(rowId: string) {\r\n    setSearchRowId(rowId);\r\n    setSearchTerm(\"\");\r\n    setSearchOpen(true);\r\n  }\r\n\r\n  function closeSearch() {\r\n    setSearchOpen(false);\r\n    setSearchRowId(null);\r\n    setSearchTerm(\"\");\r\n  }\r\n\r\n  const filteredProducts = useMemo(() => {\r\n    const t = searchTerm.trim().toLowerCase();\r\n    if (!t) return products;\r\n    return products.filter((p) => {\r\n      const code = String(p.item_code || \"\").toLowerCase();\r\n      const sku = String(p.sku || \"\").toLowerCase();\r\n      const name = String(p.name || \"\").toLowerCase();\r\n      const desc = String(p.description || \"\").toLowerCase();\r\n      return code.includes(t) || sku.includes(t) || name.includes(t) || desc.includes(t);\r\n    });\r\n  }, [products, searchTerm]);\r\n\r\n  const filteredCustomers = useMemo(() => {\r\n    const t = custSearchTerm.trim().toLowerCase();\r\n    if (!t) return customers;\r\n    return customers.filter((c) => {\r\n      const name = String(c.name || \"\").toLowerCase();\r\n      const phone = String(c.phone || \"\").toLowerCase();\r\n      const code = String(c.customer_code || \"\").toLowerCase();\r\n      const addr = String(c.address || \"\").toLowerCase();\r\n      return name.includes(t) || phone.includes(t) || code.includes(t) || addr.includes(t);\r\n    });\r\n  }, [customers, custSearchTerm]);\r\n\r\n  function openCustomerSearch() {\r\n    setCustSearchTerm(\"\");\r\n    setCustSearchOpen(true);\r\n  }\r\n\r\n  function closeCustomerSearch() {\r\n    setCustSearchOpen(false);\r\n    setCustSearchTerm(\"\");\r\n  }\r\n  \r\n  // ðŸ”” WhatsApp payment update message\r\nfunction buildWhatsAppPaymentText(opts: {\r\n  invoiceNo: string;\r\n  customerName: string;\r\n  date: string;\r\n  paidNow: number;\r\n  grossTotal: number;\r\n  balanceRemaining: number;\r\n}) {\r\n  const status =\r\n    opts.paidNow >= opts.grossTotal && opts.grossTotal > 0\r\n      ? \"PAID âœ…\"\r\n      : opts.paidNow > 0\r\n      ? \"PARTIALLY PAID âœ…\"\r\n      : \"PENDING\";\r\n\r\n  return [\r\n    `RAM POTTERY LTD`,\r\n    `Payment update for your invoice`,\r\n    ``,\r\n    `Invoice No: ${opts.invoiceNo}`,\r\n    `Date: ${opts.date}`,\r\n    `Customer: ${opts.customerName}`,\r\n    `Status: ${status}`,\r\n    ``,\r\n    `Amount Paid: Rs ${money(opts.paidNow)}`,\r\n    `Balance Remaining: Rs ${money(opts.balanceRemaining)}`,\r\n    ``,\r\n    `Thank you.`,\r\n  ].join(\"\\n\");\r\n}\r\n \r\n   // ðŸ§¾ WhatsApp invoice summary message\r\n   function buildWhatsAppText(opts: {\r\n  invoiceNo: string;\r\n  customerName: string;\r\n  total: number;\r\n  gross: number;\r\n  paid: number;\r\n  balance: number;\r\n  date: string;\r\n}) {\r\n  const status =\r\n    opts.paid >= opts.gross && opts.gross > 0\r\n      ? \"PAID âœ…\"\r\n      : opts.paid > 0\r\n      ? \"PARTIALLY PAID âœ…\"\r\n      : \"PENDING\";\r\n\r\n  return [\r\n    `RAM POTTERY LTD`,\r\n    `Invoice: ${opts.invoiceNo}`,\r\n    `Date: ${opts.date}`,\r\n    `Customer: ${opts.customerName}`,\r\n    `Status: ${status}`,\r\n    ``,\r\n    `Total Amount: Rs ${money(opts.total)}`,\r\n    `Gross Total: Rs ${money(opts.gross)}`,\r\n    `Paid: Rs ${money(opts.paid)}`,\r\n    `Balance: Rs ${money(opts.balance)}`,\r\n    ``,\r\n    `Thank you.`,\r\n  ].join(\"\\n\");\r\n}\r\n\r\n\r\n  function openWhatsAppPaymentUpdate(paidNow: number) {\r\n  const phone = normalizeMuPhone(customer?.whatsapp || customer?.phone || \"\");\r\n  if (!phone) {\r\n    alert(\"Customer phone is missing. Add phone number in customer profile.\");\r\n    return;\r\n  }\r\n\r\n  const text = buildWhatsAppPaymentText({\r\n    invoiceNo: invoiceNumber,\r\n    customerName: customer?.name || \"\",\r\n    date: invoiceDatePrint, // âœ… fixed\r\n    paidNow: n2(paidNow),\r\n    grossTotal,\r\n    balanceRemaining,\r\n  });\r\n\r\n  window.open(\r\n    `https://wa.me/${phone}?text=${encodeURIComponent(text)}`,\r\n    \"_blank\",\r\n    \"noopener,noreferrer\"\r\n  );\r\n}\r\n   \r\n \r\n  async function fetchInvoicePdf(invoiceIdOrNo: string) {\r\n  const res = await rpFetch(`/api/invoices/${encodeURIComponent(invoiceIdOrNo)}/pdf`, {\r\n    method: \"GET\",\r\n    cache: \"no-store\",\r\n  });\r\n  if (!res.ok) {\r\n    const t = await res.text().catch(() => \"\");\r\n    throw new Error(t || \"Failed to generate PDF\");\r\n  }\r\n  const blob = await res.blob();\r\n  return blob;\r\n}\r\n\r\nasync function sharePdfToWhatsApp(invoiceIdOrNo: string, messageText: string) {\r\n  const blob = await fetchInvoicePdf(invoiceIdOrNo);\r\n  const fileName = `Invoice-${invoiceIdOrNo}.pdf`;\r\n  const file = new File([blob], fileName, { type: \"application/pdf\" });\r\n\r\n  // âœ… Best: mobile share sheet (WhatsApp appears as an option)\r\n  // Works on Android Chrome + iOS Safari (modern versions)\r\n  const nav: any = navigator;\r\n\r\n  if (nav?.share && nav?.canShare?.({ files: [file] })) {\r\n    await nav.share({\r\n      title: `Invoice ${invoiceIdOrNo}`,\r\n      text: messageText,\r\n      files: [file],\r\n    });\r\n    return;\r\n  }\r\n\r\n  // Desktop fallback: download PDF + open WhatsApp with text (user attaches manually)\r\n  const url = URL.createObjectURL(blob);\r\n  const a = document.createElement(\"a\");\r\n  a.href = url;\r\n  a.download = fileName;\r\n  document.body.appendChild(a);\r\n  a.click();\r\n  a.remove();\r\n  setTimeout(() => URL.revokeObjectURL(url), 2000);\r\n\r\n  // open WhatsApp chat with message\r\n  window.open(`https://wa.me/?text=${encodeURIComponent(messageText)}`, \"_blank\", \"noopener,noreferrer\");\r\n\r\n  alert(\"PDF downloaded. Please attach it in WhatsApp Web / WhatsApp Desktop.\");\r\n}\r\n\r\n   \r\n   async function onSave() {\r\n  if (!customerId) return alert(\"Please select a customer.\");\r\n  if (!invoiceDate) return alert(\"Please select invoice date.\");\r\n  if (!salesReps.length) return alert(\"Please select at least one sales rep.\");\r\n  if (realLines.length === 0) return alert(\"Please add at least one item.\");\r\n\r\n  setSaving(true);\r\n\r\n  try {\r\n    // âœ… Build items exactly aligned with API expectations\r\n    const itemsPayload = realLines.map((l) => {\r\n      const qtyInput = Math.trunc(n2(l.box_qty)); // UI uses box_qty as qty input for both BOX/PCS\r\n      if (qtyInput <= 0) throw new Error(\"Qty must be at least 1 for all items.\");\r\n\r\n      const uom: \"BOX\" | \"PCS\" = l.uom === \"PCS\" ? \"PCS\" : \"BOX\";\r\n      const upb = uom === \"PCS\" ? 1 : Math.max(1, Math.trunc(n2(l.units_per_box) || 1));\r\n      const totalQty = uom === \"PCS\" ? qtyInput : qtyInput * upb;\r\n\r\n      return {\r\n        product_id: l.product_id,\r\n        description: l.description || null,\r\n        uom,\r\n\r\n        // âœ… send correct qty fields (API normalization expects this)\r\n        box_qty: uom === \"BOX\" ? qtyInput : null,\r\n        pcs_qty: uom === \"PCS\" ? qtyInput : null,\r\n\r\n        units_per_box: upb,\r\n        total_qty: totalQty,\r\n\r\n        unit_price_excl_vat: n2(l.unit_price_excl_vat), // already discounted in UI\r\n        vat_rate: n2(l.vat_rate),\r\n        unit_vat: n2(l.unit_vat),\r\n        unit_price_incl_vat: n2(l.unit_price_incl_vat),\r\n        line_total: n2(l.line_total),\r\n      };\r\n    });\r\n\r\n    // âœ… Recompute totals INSIDE onSave (prevents stale React memo/state in WhatsApp msg)\r\n    // Must mirror UI logic (based on discounted unit_ex + unit_vat)\r\n    const subtotalExNow = realLines.reduce(\r\n      (sum, r) => sum + n2(r.total_qty) * n2(r.unit_price_excl_vat),\r\n      0\r\n    );\r\n    const vatNow = realLines.reduce((sum, r) => sum + n2(r.total_qty) * n2(r.unit_vat), 0);\r\n    const totalNow = subtotalExNow + vatNow;\r\n\r\n    const prevNow = n2(previousBalance);\r\n    const paidNow = n2(amountPaid);\r\n\r\n    const grossNow = totalNow + prevNow;\r\n    const balanceNow = Math.max(0, grossNow - paidNow);\r\n\r\n    const payload = {\r\n      customerId,\r\n      invoiceDate,\r\n      purchaseOrderNo: purchaseOrderNo || null,\r\n\r\n      salesRep: salesReps.join(\", \"),\r\n      salesRepPhone: salesRepPhones || salesReps.map(repPhoneByName).filter(Boolean).join(\", \"),\r\n\r\n      previousBalance: prevNow,\r\n      amountPaid: paidNow,\r\n\r\n      discountPercent: n2(discountPercent),\r\n      discountAmount: n2(discountAmount), // optional (display), API will ignore in LINE_DISCOUNTED if you want\r\n      pricingMode: \"LINE_DISCOUNTED\",\r\n\r\n      partyType: customerNameType,\r\n\r\n      items: itemsPayload,\r\n    };\r\n\r\n    const res = await rpFetch(\"/api/invoices/create\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(payload),\r\n    });\r\n\r\n    const json = await res.json().catch(() => ({}));\r\n    if (!res.ok || !json?.ok) throw new Error(json?.error || \"Failed to create invoice\");\r\n\r\n    const invNo = String(json.invoiceNumber || \"(Saved)\");\r\n    setInvoiceNumber(invNo);\r\n\r\n    // âœ… Auto WhatsApp when PAID or PARTIALLY PAID (with PDF share)\r\n    if (paidNow > 0) {\r\n      setTimeout(() => {\r\n        const msg = buildWhatsAppPaymentText({\r\n          invoiceNo: invNo,\r\n          customerName: customer?.name || \"\",\r\n          date: invoiceDatePrint,\r\n          paidNow: paidNow,\r\n          grossTotal: grossNow,\r\n          balanceRemaining: balanceNow,\r\n        });\r\n\r\n        // Share PDF + message (mobile share sheet OR desktop fallback)\r\n        sharePdfToWhatsApp(invNo, msg).catch((e) =>\r\n          alert(e?.message || \"Failed to share invoice PDF\")\r\n        );\r\n      }, 250);\r\n    }\r\n\r\n    alert(`Invoice saved: ${invNo}`);\r\n  } catch (err: any) {\r\n    alert(err?.message || \"Failed to create invoice\");\r\n  } finally {\r\n    setSaving(false);\r\n  }\r\n}\r\n\r\n\r\n\r\n    function onPrint() {\r\n    setPrinting(true);\r\n\r\n    document.documentElement.classList.add(\"rp-printing\");\r\n\r\n    const cleanup = () => {\r\n      document.documentElement.classList.remove(\"rp-printing\");\r\n      setPrinting(false);\r\n      window.removeEventListener(\"afterprint\", cleanup);\r\n    };\r\n\r\n    window.addEventListener(\"afterprint\", cleanup);\r\n\r\n    // give DOM + fonts + images a moment to render\r\n    setTimeout(() => {\r\n      window.print();\r\n    }, 200);\r\n\r\n    // fallback cleanup\r\n    setTimeout(cleanup, 5000);\r\n  }\r\n\r\n  // PRINT DATA\r\n  const docItems = useMemo(() => {\r\n    return realLines.map((r, i) => ({\r\n      sn: i + 1,\r\n      item_code: r.item_code,\r\n      uom: r.uom,\r\n      box_qty: Math.trunc(n2(r.box_qty)),\r\n      units_per_box: Math.trunc(n2(r.units_per_box)),\r\n      total_qty: Math.trunc(n2(r.total_qty)),\r\n      description: r.description,\r\n      unit_price_excl_vat: n2(r.unit_price_excl_vat),\r\n      unit_vat: n2(r.unit_vat),\r\n      unit_price_incl_vat: n2(r.unit_price_incl_vat),\r\n      line_total: n2(r.line_total),\r\n    }));\r\n  }, [realLines]);\r\n\r\n  const salesRepNamePrint = salesReps.join(\", \");\r\n  const salesRepPhonePrint =\r\n    salesRepPhones || salesReps.map(repPhoneByName).filter(Boolean).join(\", \");\r\n\r\n  return (\r\n    <div className=\"inv-page\">\r\n      {/* Top actions */}\r\n      <div className=\"inv-actions inv-screen\">\r\n        <button type=\"button\" className=\"rp-btn rp-btn--ghost\" onClick={() => router.back()}>\r\n          â† Back\r\n        </button>\r\n\r\n        <div className=\"inv-actions-right\">\r\n          <button type=\"button\" className=\"rp-btn\" onClick={addRow}>\r\n            + Add Row\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            className=\"rp-btn rp-btn--ghost\"\r\n            disabled={!customerId}\r\n            title=\"Send payment update on WhatsApp\"\r\n            onClick={() => {\r\n            if (n2(amountPaid) <= 0) {\r\n            alert(\"Enter an amount paid to send payment update.\");\r\n            return;\r\n           }\r\n           openWhatsAppPaymentUpdate(n2(amountPaid));\r\n         }}\r\n        >\r\n         WhatsApp\r\n        </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            className=\"rp-btn\"\r\n            onClick={onPrint}\r\n            disabled={printing}\r\n            title=\"Print A4 invoice\"\r\n          >\r\n            {printing ? \"Preparingâ€¦\" : \"Print\"}\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            className=\"rp-btn rp-btn--primary\"\r\n            onClick={onSave}\r\n            disabled={saving}\r\n          >\r\n            {saving ? \"Savingâ€¦\" : \"Save Invoice\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* ==========================\r\n         SCREEN (everything editable)\r\n         ========================== */}\r\n      <div className=\"inv-screen inv-form-shell\">\r\n        <div className=\"inv-form-card\">\r\n          <div className=\"inv-form-head\">\r\n            <div>\r\n              <div className=\"inv-form-title\">New VAT Invoice</div>\r\n              <div className=\"inv-form-sub\">A4 Print Template Locked (Ram Pottery)</div>\r\n\r\n              {dupFromNo ? (\r\n                <div className=\"inv-dup-badge\">\r\n                  Duplicated from <b>{dupFromNo}</b>\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n\r\n            <div className=\"inv-form-meta\">\r\n              <div className=\"inv-meta-row\">\r\n                <span className=\"inv-meta-k\">Invoice No</span>\r\n                <span className=\"inv-meta-v\">{invoiceNumber}</span>\r\n              </div>\r\n              <div className=\"inv-meta-row\">\r\n                <span className=\"inv-meta-k\">Date</span>\r\n                <span className=\"inv-meta-v\">{invoiceDate || \"â€”\"}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"inv-form-grid\">\r\n            {/* Customer Type selector */}\r\n            <div className=\"inv-field inv-field--type\">\r\n              <label>Customer Type</label>\r\n              <select\r\n                className=\"inv-input\"\r\n                value={customerNameType}\r\n                onChange={(e) => {\r\n                  setCustomerNameTypeTouched(true);\r\n                  setCustomerNameType(e.target.value as any);\r\n                }}\r\n              >\r\n                <option value=\"COMPANY\">Company Name</option>\r\n                <option value=\"CLIENT\">Client Name</option>\r\n              </select>\r\n              <div className=\"inv-help\">Affects the label shown on the invoice header.</div>\r\n            </div>\r\n\r\n            {/* Customer select + search */}\r\n            <div className=\"inv-field inv-field--customer\">\r\n              <label>{customerNameType === \"COMPANY\" ? \"Company Name\" : \"Client Name\"}</label>\r\n\r\n              <div className=\"inv-customer-row\">\r\n                <select\r\n                  className=\"inv-input\"\r\n                  value={customerId ?? \"\"}\r\n                  onChange={(e) => {\r\n                    setCustomerId(e.target.value ? Number(e.target.value) : null);\r\n                  }}\r\n                >\r\n                  <option value=\"\">Selectâ€¦</option>\r\n                  {customers.map((c) => (\r\n                    <option key={c.id} value={c.id}>\r\n                      {c.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"rp-btn rp-btn--ghost inv-search-btn\"\r\n                  onClick={openCustomerSearch}\r\n                  title=\"Search customer\"\r\n                >\r\n                  ðŸ” Search\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"inv-help\">\r\n                {customer ? (\r\n                  <>\r\n                    <span>{customer.address}</span> Â· <span>{customer.phone}</span>\r\n                  </>\r\n                ) : (\r\n                  <span>Select a customer (or use Search)</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Invoice Date */}\r\n            <div className=\"inv-field inv-field--date\">\r\n              <label>Invoice Date</label>\r\n              <input\r\n                className=\"inv-input\"\r\n                type=\"date\"\r\n                value={invoiceDate}\r\n                onChange={(e) => setInvoiceDate(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            {/* PO */}\r\n            <div className=\"inv-field inv-field--po\">\r\n              <label>Purchase Order No (optional)</label>\r\n              <input\r\n                className=\"inv-input\"\r\n                value={purchaseOrderNo}\r\n                onChange={(e) => setPurchaseOrderNo(e.target.value)}\r\n                placeholder=\"Optional\"\r\n              />\r\n            </div>\r\n\r\n            {/* Sales Reps */}\r\n            <div className=\"inv-field inv-field--reps\">\r\n              <label>Sales Rep(s)</label>\r\n\r\n              <div className=\"inv-rep\">\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"inv-rep-btn\"\r\n                  onClick={() => setRepOpen((v) => !v)}\r\n                  aria-expanded={repOpen}\r\n                >\r\n                  <div className=\"inv-rep-chips\">\r\n                    {salesReps.length ? (\r\n                      salesReps.map((n) => (\r\n                        <span key={n} className=\"inv-chip\">\r\n                          {n} ({repPhoneByName(n)})\r\n                          <span\r\n                            className=\"inv-chip-x\"\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              const next = salesReps.filter((x) => x !== n);\r\n                              setSalesReps(next);\r\n                              setSalesRepPhones(next.map(repPhoneByName).filter(Boolean).join(\", \"));\r\n                            }}\r\n                            title=\"Remove\"\r\n                          >\r\n                            Ã—\r\n                          </span>\r\n                        </span>\r\n                      ))\r\n                    ) : (\r\n                      <span className=\"inv-rep-placeholder\">Select sales repsâ€¦</span>\r\n                    )}\r\n                  </div>\r\n                  <span className=\"inv-rep-caret\">â–¾</span>\r\n                </button>\r\n\r\n                {repOpen ? (\r\n                  <div className=\"inv-rep-pop\" onMouseDown={(e) => e.stopPropagation()}>\r\n                    {SALES_REPS.map((r) => {\r\n                      const active = salesReps.includes(r.name);\r\n                      return (\r\n                        <button\r\n                          key={r.name}\r\n                          type=\"button\"\r\n                          className={\"inv-rep-item\" + (active ? \" is-active\" : \"\")}\r\n                          onClick={() => {\r\n                            const next = active\r\n                              ? salesReps.filter((x) => x !== r.name)\r\n                              : [...salesReps, r.name];\r\n\r\n                            setSalesReps(next);\r\n                            setSalesRepPhones(next.map(repPhoneByName).filter(Boolean).join(\", \"));\r\n\r\n                            setRepOpen(false);\r\n                          }}\r\n                        >\r\n                          <span className=\"inv-rep-name\">{r.name}</span>\r\n                          <span className=\"inv-rep-phone\">{r.phone}</span>\r\n                          <span className=\"inv-rep-check\">{active ? \"âœ“\" : \"\"}</span>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                    <div className=\"inv-rep-hint\">Click to select. Click again to remove.</div>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            </div>\r\n\r\n            {/* VAT */}\r\n            <div className=\"inv-field inv-field--vat\">\r\n              <label>VAT % (applies to all items)</label>\r\n              <select\r\n                className=\"inv-input\"\r\n                value={vatPercent}\r\n                onChange={(e) => {\r\n                  const next = n2(e.target.value) === 0 ? 0 : 15;\r\n                  setVatPercent(next);\r\n                  setLines((prev) => prev.map((r) => recalc({ ...r, vat_rate: next } as InvoiceLine)));\r\n                }}\r\n              >\r\n                <option value={15}>15%</option>\r\n                <option value={0}>0%</option>\r\n              </select>\r\n            </div>\r\n\r\n            {/* Discount */}\r\n            <div className=\"inv-field inv-field--discount\">\r\n              <label>Discount % (Party-wise)</label>\r\n              <input className=\"inv-input inv-input--right\" value={fmtNumber(discountPercent)} readOnly />\r\n              <div className=\"inv-help\">\r\n                {customer ? (\r\n                  <span>\r\n                    Auto from <b>{customer.name}</b>: {fmtNumber(n2(customer.discount_percent ?? 0))}%\r\n                  </span>\r\n                ) : (\r\n                  <span>Auto-fills when you select a customer</span>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Previous Balance */}\r\n            <div className=\"inv-field inv-field--prev\">\r\n              <label>Previous Balance</label>\r\n              <input\r\n                className=\"inv-input inv-input--right\"\r\n                inputMode=\"decimal\"\r\n                value={previousBalance}\r\n                onChange={(e) => {\r\n                  setPrevTouched(true);\r\n                  setPreviousBalance(n2(e.target.value));\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            {/* Amount Paid */}\r\n            <div className=\"inv-field inv-field--paid\">\r\n              <label>Amount Paid</label>\r\n              <input\r\n                className=\"inv-input inv-input--right\"\r\n                inputMode=\"decimal\"\r\n                value={amountPaid}\r\n                onChange={(e) => {\r\n                  setPaidTouched(true);\r\n                  setAmountPaid(n2(e.target.value));\r\n                }}\r\n              />\r\n              <div className=\"inv-help\">If Amount Paid &gt; 0, WhatsApp prompt opens after Save.</div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ITEMS TABLE (SCREEN) */}\r\n          <div className=\"inv-items\">\r\n            <div className=\"inv-items-head\">\r\n              <div className=\"inv-items-title\">Items</div>\r\n              <div className=\"inv-items-sub\">Matches printed invoice columns (A4).</div>\r\n            </div>\r\n\r\n            <div className=\"inv-table-wrap\">\r\n              <table className=\"inv-table inv-table--invoiceCols\">\r\n                {/* âœ… Hydration-safe colgroup (NO whitespace) */}\r\n                <colgroup>\r\n                  <col style={{ width: \"4%\" }} />\r\n                  <col style={{ width: \"30%\" }} />\r\n                  <col style={{ width: \"16%\" }} />\r\n                  <col style={{ width: \"8%\" }} />\r\n                  <col style={{ width: \"8%\" }} />\r\n                  <col style={{ width: \"10%\" }} />\r\n                  <col style={{ width: \"6%\" }} />\r\n                  <col style={{ width: \"10%\" }} />\r\n                  <col style={{ width: \"12%\" }} />\r\n                  <col style={{ width: \"4%\" }} />\r\n                </colgroup>\r\n\r\n                <thead>\r\n                  <tr>\r\n                    <th className=\"inv-th inv-th-center\">#</th>\r\n                    <th className=\"inv-th\">PRODUCT</th>\r\n                    <th className=\"inv-th inv-th-center\">BOX / PCS</th>\r\n                    <th className=\"inv-th inv-th-center\">UNIT</th>\r\n                    <th className=\"inv-th inv-th-center\">TOTAL QTY</th>\r\n                    <th className=\"inv-th inv-th-right\">UNIT&nbsp;EX</th>\r\n                    <th className=\"inv-th inv-th-right\">VAT</th>\r\n                    <th className=\"inv-th inv-th-right\">UNIT&nbsp;INC</th>\r\n                    <th className=\"inv-th inv-th-right\">TOTAL</th>\r\n                    <th className=\"inv-th inv-th-center\" />\r\n                  </tr>\r\n                </thead>\r\n\r\n                <tbody>\r\n                  {lines.map((r, idx) => {\r\n                    const isReal = !!r.product_id;\r\n\r\n                    return (\r\n                      <tr key={r.id} className={removingIds.has(r.id) ? \"inv-row--removing\" : \"\"}>\r\n                        <td className=\"inv-td inv-center\">{idx + 1}</td>\r\n\r\n                        {/* PRODUCT selector */}\r\n                        <td className=\"inv-td\">\r\n                          <div className=\"inv-itemcode-cell--prod\">\r\n                            <select\r\n                              className=\"inv-input inv-input--prod\"\r\n                              value={r.product_id ?? \"\"}\r\n                              onChange={(e) => {\r\n                                const pid = e.target.value ? Number(e.target.value) : null;\r\n                                const p = pid ? products.find((x) => x.id === pid) || null : null;\r\n                                applyProductToRow(r.id, p);\r\n                              }}\r\n                            >\r\n                              <option value=\"\">Selectâ€¦</option>\r\n                              {products.map((p) => (\r\n                                <option key={p.id} value={p.id}>\r\n                                  {p.item_code} â€” {p.name}\r\n                                </option>\r\n                              ))}\r\n                            </select>\r\n\r\n                            <button\r\n                              type=\"button\"\r\n                              className=\"inv-search-mini\"\r\n                              onClick={() => openSearchForRow(r.id)}\r\n                              title=\"Search product\"\r\n                            >\r\n                              ðŸ”\r\n                            </button>\r\n                          </div>\r\n                        </td>\r\n\r\n                        {/* BOX / PCS + Qty */}\r\n                        <td className=\"inv-td inv-center\">\r\n                          <div className=\"inv-boxcell inv-boxcell--premium\">\r\n                            <select\r\n                              className=\"inv-input inv-input--uom\"\r\n                              value={r.uom}\r\n                              onChange={(e) => setLine(r.id, { uom: e.target.value as any })}\r\n                              disabled={!isReal}\r\n                            >\r\n                              <option value=\"BOX\">BOX</option>\r\n                              <option value=\"PCS\">PCS</option>\r\n                            </select>\r\n\r\n                            <input\r\n                              className=\"inv-input inv-input--qty inv-input--qtywide inv-center\"\r\n                              value={r.box_qty}\r\n                              onChange={(e) => setLine(r.id, { box_qty: n2(e.target.value) })}\r\n                              onKeyDown={(e) => {\r\n                                if (e.key !== \"Enter\") return;\r\n                                if (e.shiftKey) return; // Shift+Enter is Save (handled globally)\r\n                                if (!isReal) return;\r\n\r\n                                const isLast = idx === lines.length - 1;\r\n                                const q = Math.trunc(n2((e.target as HTMLInputElement).value));\r\n\r\n                                if (isLast && q >= 1) {\r\n                                  e.preventDefault();\r\n                                  addRow();\r\n                                  setTimeout(() => {\r\n                                    const qtyInputs = Array.from(\r\n                                      document.querySelectorAll<HTMLInputElement>(\".inv-input--qtywide\")\r\n                                    );\r\n                                    const last = qtyInputs[qtyInputs.length - 1];\r\n                                    last?.focus();\r\n                                    last?.select?.();\r\n                                  }, 0);\r\n                                }\r\n                              }}\r\n                              disabled={!isReal}\r\n                              inputMode=\"numeric\"\r\n                              placeholder=\"0\"\r\n                            />\r\n                          </div>\r\n                        </td>\r\n\r\n                        {/* UNIT/BOX */}\r\n                        <td className=\"inv-td inv-center\">\r\n                          <input\r\n                            className=\"inv-input inv-center\"\r\n                            value={r.uom === \"PCS\" ? \"\" : intFmt(r.units_per_box)}\r\n                            readOnly\r\n                          />\r\n                        </td>\r\n\r\n                        {/* TOTAL QTY */}\r\n                        <td className=\"inv-td inv-center\">\r\n                          <input className=\"inv-input inv-center\" value={intFmt(r.total_qty)} readOnly />\r\n                        </td>\r\n\r\n                        {/* PRICES */}\r\n                        <td className=\"inv-td inv-right\">\r\n                          <input\r\n                            className=\"inv-input inv-input--right\"\r\n                            value={money(r.unit_price_excl_vat)}\r\n                            readOnly\r\n                          />\r\n                        </td>\r\n                        <td className=\"inv-td inv-right\">\r\n                          <input className=\"inv-input inv-input--right\" value={money(r.unit_vat)} readOnly />\r\n                        </td>\r\n                        <td className=\"inv-td inv-right\">\r\n                          <input\r\n                            className=\"inv-input inv-input--right\"\r\n                            value={money(r.unit_price_incl_vat)}\r\n                            readOnly\r\n                          />\r\n                        </td>\r\n                        <td className=\"inv-td inv-right\">\r\n                          <input\r\n                            className=\"inv-input inv-input--right inv-input--total\"\r\n                            value={money(r.line_total)}\r\n                            readOnly\r\n                          />\r\n                        </td>\r\n\r\n                        <td className=\"inv-td inv-center\">\r\n                          <button\r\n                            type=\"button\"\r\n                            className=\"inv-xmini\"\r\n                            onClick={() => removeRow(r.id)}\r\n                            title=\"Remove row\"\r\n                          >\r\n                            âœ•\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n\r\n            {/* Totals preview */}\r\n            <div className=\"inv-totalsbar inv-totalsbar--premium\">\r\n              <div>\r\n                <b>Sub Total:</b> {money(subtotalEx)}\r\n              </div>\r\n              <div>\r\n                <b>VAT:</b> {money(vatAmount)}\r\n              </div>\r\n              <div>\r\n                <b>Discount:</b> {money(discountAmount)}\r\n              </div>\r\n              <div>\r\n                <b>Total:</b> {money(totalAmount)}\r\n              </div>\r\n              <div>\r\n                <b>Gross:</b> {money(grossTotal)}\r\n              </div>\r\n              <div>\r\n                <b>Balance:</b> {money(balanceRemaining)}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* ===========================\r\n              Product Search Modal\r\n             =========================== */}\r\n          {searchOpen ? (\r\n            <div className=\"inv-modal-backdrop\" onMouseDown={closeSearch}>\r\n              <div className=\"inv-modal\" onMouseDown={(e) => e.stopPropagation()}>\r\n                <div className=\"inv-modal-head\">\r\n                  <div className=\"inv-modal-title\">Search Product</div>\r\n                  <button type=\"button\" className=\"rp-btn rp-btn--ghost\" onClick={closeSearch}>\r\n                    Close\r\n                  </button>\r\n                </div>\r\n\r\n                <div className=\"inv-modal-body\">\r\n                  <input\r\n                    className=\"inv-input\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    placeholder=\"Search by code, sku, name, descriptionâ€¦\"\r\n                    autoFocus\r\n                  />\r\n\r\n                  <div className=\"inv-modal-list\">\r\n                    {filteredProducts.slice(0, 150).map((p) => (\r\n                      <button\r\n                        key={p.id}\r\n                        type=\"button\"\r\n                        className=\"inv-modal-item\"\r\n                        onClick={() => {\r\n                          if (searchRowId) applyProductToRow(searchRowId, p);\r\n                          closeSearch();\r\n                        }}\r\n                      >\r\n                        <div className=\"inv-modal-item-title\">\r\n                          <b>{p.item_code || p.sku}</b> â€” {p.name}\r\n                        </div>\r\n                        <div className=\"inv-modal-item-sub\">\r\n                          UNIT: {intFmt(p.units_per_box ?? 1)} Â· Unit Ex: {money(p.price_excl_vat ?? 0)}\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n\r\n          {/* ===========================\r\n              Customer Search Modal\r\n             =========================== */}\r\n          {custSearchOpen ? (\r\n            <div className=\"inv-modal-backdrop\" onMouseDown={closeCustomerSearch}>\r\n              <div className=\"inv-modal\" onMouseDown={(e) => e.stopPropagation()}>\r\n                <div className=\"inv-modal-head\">\r\n                  <div className=\"inv-modal-title\">Search Customer</div>\r\n                  <button type=\"button\" className=\"rp-btn rp-btn--ghost\" onClick={closeCustomerSearch}>\r\n                    Close\r\n                  </button>\r\n                </div>\r\n\r\n                <div className=\"inv-modal-body\">\r\n                  <input\r\n                    className=\"inv-input\"\r\n                    value={custSearchTerm}\r\n                    onChange={(e) => setCustSearchTerm(e.target.value)}\r\n                    placeholder=\"Search by name, code, phone, addressâ€¦\"\r\n                    autoFocus\r\n                  />\r\n\r\n                  <div className=\"inv-modal-list\">\r\n                    {filteredCustomers.slice(0, 200).map((c) => (\r\n                      <button\r\n                        key={c.id}\r\n                        type=\"button\"\r\n                        className=\"inv-modal-item\"\r\n                        onClick={() => {\r\n                          setCustomerId(c.id);\r\n                          closeCustomerSearch();\r\n                        }}\r\n                      >\r\n                        <div className=\"inv-modal-item-title\">\r\n                          <b>{c.name}</b> <span className=\"inv-muted\">({c.customer_code})</span>\r\n                        </div>\r\n                        <div className=\"inv-modal-item-sub\">\r\n                          {c.phone} Â· {c.address}\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n\r\n      {/* ==========================\r\n         PRINT ONLY (must be OUTSIDE inv-screen)\r\n         ========================== */}\r\n      <div className=\"inv-printonly\">\r\n        <RamPotteryDoc\r\n          variant=\"INVOICE\"\r\n          docNoLabel=\"INVOICE NO:\"\r\n          docNoValue={invoiceNumber}\r\n          dateLabel=\"DATE:\"\r\n          dateValue={invoiceDatePrint}\r\n          purchaseOrderLabel=\"PURCHASE ORDER NO:\"\r\n          purchaseOrderValue={purchaseOrderNo || \"\"}\r\n          salesRepName={salesRepNamePrint}\r\n          salesRepPhone={salesRepPhonePrint}\r\n          customer={{\r\n            name: customer?.name || \"\",\r\n            address: customer?.address || \"\",\r\n            phone: customer?.phone || \"\",\r\n            brn: customer?.brn || \"\",\r\n            vat_no: customer?.vat_no || \"\",\r\n            customer_code: customer?.customer_code || \"\",\r\n          }}\r\n          company={{\r\n            brn: \"C17144377\",\r\n            vat_no: \"123456789\",\r\n          }}\r\n          items={docItems}\r\n          totals={{\r\n            subtotal: subtotalEx,\r\n            vatPercentLabel: `VAT`,\r\n            vat_amount: vatAmount,\r\n            total_amount: totalAmount,\r\n            previous_balance: previousBalance,\r\n            amount_paid: amountPaid,\r\n            balance_remaining: balanceRemaining,\r\n            discount_percent: discountPercent,\r\n            discount_amount: discountAmount,\r\n          }}\r\n          preparedBy=\"Manish\"\r\n          deliveredBy=\"\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}